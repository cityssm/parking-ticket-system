"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),(()=>{var e;let t="";const o=document.querySelector("#locationFilter--locationClassKey"),n=document.querySelector("#locationFilter--locationName"),a=document.querySelector("#locationResults");let s=exports.locations;function i(e){e.preventDefault();const o=Number.parseInt(e.currentTarget.dataset.index,10),n=s[o];let a;const i=()=>{cityssm.postJSON("/admin/doDeleteLocation",{locationKey:n.locationKey},e=>{e.success&&(a(),s=e.locations,l())})};function c(e){e.preventDefault(),cityssm.confirmModal("Delete Location",`Are you sure you want to remove "${n.locationName}" from the list of available options?`,"Yes, Remove Location","danger",i)}function r(e){e.preventDefault(),cityssm.postJSON("/admin/doUpdateLocation",e.currentTarget,e=>{e.success&&(a(),s=e.locations,l())})}cityssm.openHtmlModal("location-edit",{onshow(){document.querySelector("#editLocation--locationKey").value=n.locationKey;const e=document.querySelector("#editLocation--locationClassKey");e.innerHTML=t,e.querySelector("[value='"+n.locationClassKey+"']")||e.insertAdjacentHTML("beforeend",'<option value="'+cityssm.escapeHTML(n.locationClassKey)+'">'+cityssm.escapeHTML(n.locationClassKey)+"</option>"),e.value=n.locationClassKey,document.querySelector("#editLocation--locationName").value=n.locationName},onshown(e,t){var o,n;bulmaJS.toggleHtmlClipped(),a=t,null===(o=document.querySelector("#form--editLocation"))||void 0===o||o.addEventListener("submit",r),null===(n=e.querySelector(".is-delete-button"))||void 0===n||n.addEventListener("click",c)},onhidden(){bulmaJS.toggleHtmlClipped()}})}function l(){let e=0;const t=o.value,l=n.value.trim().toLowerCase().split(" "),c=document.createElement("tbody");for(const[o,n]of s.entries()){if(""!==t&&t!==n.locationClassKey)continue;let a=!0;const s=n.locationName.toLowerCase();for(const e of l)if(!s.includes(e)){a=!1;break}if(!a)continue;e+=1;const r=pts.getLocationClass(n.locationClassKey).locationClass,d=document.createElement("tr");d.innerHTML='<td><a data-index="'+o.toString()+'" href="#">'+cityssm.escapeHTML(n.locationName)+"</a></td><td>"+cityssm.escapeHTML(r)+"</td>",d.querySelector("a").addEventListener("click",i),c.append(d)}cityssm.clearElement(a),0!==e?(a.innerHTML='<table class="table is-fixed is-striped is-hoverable is-fullwidth"><thead><tr><th>Location</th><th>Class</th></tr></thead></table>',a.querySelector("table").append(c)):a.innerHTML='<div class="message is-info"><div class="message-body">There are no locations that meet your search criteria.</div></div>'}delete exports.locations,o.addEventListener("change",l),n.addEventListener("keyup",l),pts.getDefaultConfigProperty("locationClasses",e=>{o.innerHTML='<option value="">(All Location Classes)</option>';for(const o of e)t+=`<option value="${o.locationClassKey}">\n          ${cityssm.escapeHTML(o.locationClass)}\n          </option>`;o.insertAdjacentHTML("beforeend",t),l()}),null===(e=document.querySelector("#is-add-location-button"))||void 0===e||e.addEventListener("click",e=>{let o;e.preventDefault();const n=e=>{e.preventDefault(),cityssm.postJSON("/admin/doAddLocation",e.currentTarget,e=>{var t;e.success?(o(),s=e.locations,l()):cityssm.alertModal("Location Not Added",null!==(t=e.message)&&void 0!==t?t:"","OK","danger")})};cityssm.openHtmlModal("location-add",{onshown(e,a){var s,i;o=a,null===(s=document.querySelector("#addLocation--locationClassKey"))||void 0===s||s.insertAdjacentHTML("beforeend",t),null===(i=document.querySelector("#form--addLocation"))||void 0===i||i.addEventListener("submit",n)}})})})();