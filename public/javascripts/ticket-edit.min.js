var $jscomp={scope:{}};$jscomp.defineProperty="function"==typeof Object.defineProperties?Object.defineProperty:function(a,d,c){if(c.get||c.set)throw new TypeError("ES3 does not support getters and setters.");a!=Array.prototype&&a!=Object.prototype&&(a[d]=c.value)};$jscomp.getGlobal=function(a){return"undefined"!=typeof window&&window===a?a:"undefined"!=typeof global&&null!=global?global:a};$jscomp.global=$jscomp.getGlobal(this);$jscomp.SYMBOL_PREFIX="jscomp_symbol_";
$jscomp.initSymbol=function(){$jscomp.initSymbol=function(){};$jscomp.global.Symbol||($jscomp.global.Symbol=$jscomp.Symbol)};$jscomp.symbolCounter_=0;$jscomp.Symbol=function(a){return $jscomp.SYMBOL_PREFIX+(a||"")+$jscomp.symbolCounter_++};
$jscomp.initSymbolIterator=function(){$jscomp.initSymbol();var a=$jscomp.global.Symbol.iterator;a||(a=$jscomp.global.Symbol.iterator=$jscomp.global.Symbol("iterator"));"function"!=typeof Array.prototype[a]&&$jscomp.defineProperty(Array.prototype,a,{configurable:!0,writable:!0,value:function(){return $jscomp.arrayIterator(this)}});$jscomp.initSymbolIterator=function(){}};$jscomp.arrayIterator=function(a){var d=0;return $jscomp.iteratorPrototype(function(){return d<a.length?{done:!1,value:a[d++]}:{done:!0}})};
$jscomp.iteratorPrototype=function(a){$jscomp.initSymbolIterator();a={next:a};a[$jscomp.global.Symbol.iterator]=function(){return this};return a};$jscomp.array=$jscomp.array||{};$jscomp.iteratorFromArray=function(a,d){$jscomp.initSymbolIterator();a instanceof String&&(a+="");var c=0,f={next:function(){if(c<a.length){var e=c++;return{value:d(e,a[e]),done:!1}}f.next=function(){return{done:!0,value:void 0}};return f.next()}};f[Symbol.iterator]=function(){return f};return f};
$jscomp.polyfill=function(a,d,c,f){if(d){c=$jscomp.global;a=a.split(".");for(f=0;f<a.length-1;f++){var e=a[f];e in c||(c[e]={});c=c[e]}a=a[a.length-1];f=c[a];d=d(f);d!=f&&null!=d&&$jscomp.defineProperty(c,a,{configurable:!0,writable:!0,value:d})}};$jscomp.polyfill("Array.prototype.values",function(a){return a?a:function(){return $jscomp.iteratorFromArray(this,function(a,c){return c})}},"es6","es3");
(function(){for(var a=document.getElementById("ticket--ticketID").value,d=""===a,c=document.getElementById("container--form-message"),f=function(b){pts.enableNavBlocker();c.innerHTML='<span class="tag is-light is-info is-medium"><span class="icon"><i class="fas fa-exclamation-triangle" aria-hidden="true"></i></span> <span>Unsaved Changes</span></div>'},e=document.querySelectorAll(".input, .select, .textarea"),k=0;k<e.length;k+=1)e[k].addEventListener("change",f);document.getElementById("form--ticket").addEventListener("submit",
function(b){b.preventDefault();var a=document.getElementById("ticket--ticketNumber").value;c.innerHTML='<span class="tag is-light is-info is-medium"><span>Saving ticket... </span> <span class="icon"><i class="fas fa-circle-notch fa-spin" aria-hidden="true"></i></span></div>';pts.postJSON(d?"/tickets/doCreateTicket":"/tickets/doUpdateTicket",b.currentTarget,function(b){b.success?(pts.disableNavBlocker(),c.innerHTML='<span class="tag is-light is-success is-medium"><span class="icon"><i class="fas fa-check" aria-hidden="true"></i></span> <span>Saved Successfully</span></div>'):
(f(),pts.alertModal("Ticket Not Saved",b.message,"OK","danger"));b.success&&d&&pts.openHtmlModal("ticket-createSuccess",{onshow:function(){document.getElementById("createSuccess--ticketNumber").innerText=a;document.getElementById("createSuccess--editTicketButton").setAttribute("href","/tickets/"+b.ticketID+"/edit");document.getElementById("createSuccess--newTicketButton").setAttribute("href","/tickets/new/"+b.nextTicketNumber)}})})});pts.getDefaultConfigProperty("locationClasses",function(b){for(var a,
r={},c={},g=0;g<b.length;g+=1){var d=b[g];r[d.locationClassKey]=d}var e=function(b){b.preventDefault();b=c[parseInt(b.currentTarget.getAttribute("data-index"))];document.getElementById("ticket--locationKey").value=b.locationKey;document.getElementById("ticket--locationName").value=b.locationName;a();c=[]},f=function(){pts.postJSON("/offences/doGetAllLocations",{},function(b){c=b;b=document.createElement("div");b.className="list is-hoverable";for(var a=0;a<c.length;a+=1){var h=c[a],d=r[h.locationClassKey],
g=document.createElement("a");g.className="list-item";g.setAttribute("data-index",a);g.setAttribute("href","#");g.addEventListener("click",e);g.innerHTML='<div class="level"><div class="level-left">'+pts.escapeHTML(h.locationName)+"</div>"+(d?'<div class="level-right"><span class="tag is-primary">'+pts.escapeHTML(d.locationClass)+"</span></div>":"")+"</div>";b.insertAdjacentElement("beforeend",g)}a=document.getElementById("container--parkingLocations");pts.clearElement(a);a.insertAdjacentElement("beforeend",
b)})};b=function(b){b.preventDefault();pts.openHtmlModal("ticket-setLocation",{onshown:function(b,h){a=h;f()},onremoved:function(){document.getElementById("is-location-lookup-button").focus()}})};document.getElementById("is-location-lookup-button").addEventListener("click",b);document.getElementById("ticket--locationName").addEventListener("dblclick",b)});var t,l=[],w=function(b){b.preventDefault();b=l[parseInt(b.currentTarget.getAttribute("data-index"))];document.getElementById("ticket--bylawNumber").value=
b.bylawNumber;var a=document.getElementById("ticket--offenceAmount");a.classList.add("is-readonly");a.setAttribute("readonly","readonly");a.closest(".field").getElementsByClassName("is-unlock-field-button")[0].removeAttribute("disabled");a.value=b.offenceAmount;document.getElementById("ticket--parkingOffence").value=b.bylawDescription;t();l=[]},x=function(){var b=document.getElementById("ticket--locationKey").value;document.getElementById("ticket--locationName");pts.postJSON("/offences/doGetOffencesByLocation",
{locationKey:b},function(b){l=b;b=document.createElement("div");b.className="list is-hoverable has-margin-bottom-20";for(var a=0;a<l.length;a+=1){var h=l[a],g=document.createElement("a");g.className="list-item";g.setAttribute("data-index",a);g.setAttribute("href","#");g.addEventListener("click",w);g.innerHTML='<div class="columns">'+('<div class="column">'+pts.escapeHTML(h.bylawNumber)+"<br /><small>"+pts.escapeHTML(h.bylawDescription)+"</small></div>")+('<div class="column is-narrow">$ '+h.offenceAmount.toFixed(2)+
"</div>")+"</div>";b.insertAdjacentElement("beforeend",g)}a=document.getElementById("container--bylawNumbers");pts.clearElement(a);a.appendChild(b)})},e=function(b){b.preventDefault();pts.openHtmlModal("ticket-setBylawOffence",{onshown:function(b,a){t=a;x();document.getElementById("bylawLookup--searchStr").focus()},onremoved:function(){document.getElementById("is-bylaw-lookup-button").focus()}})};document.getElementById("is-bylaw-lookup-button").addEventListener("click",e);document.getElementById("ticket--bylawNumber").addEventListener("dblclick",
e);e=function(){var b=document.getElementById("datalist--licencePlateProvince");pts.clearElement(b);var a=pts.getLicencePlateCountryProperties(document.getElementById("ticket--licencePlateCountry").value);if(a&&a.provinces)for(var a=Object.values(a.provinces),c=0;c<a.length;c+=1){var d=document.createElement("option");d.setAttribute("value",a[c].provinceShortName);b.appendChild(d)}};document.getElementById("ticket--licencePlateCountry").addEventListener("change",e);pts.loadDefaultConfigProperties(e);
if(!d){var n=document.getElementById("is-remark-panel"),m=pts.ticketRemarksInit;delete pts.ticketRemarksInit;var p,y=function(b){var h=b.currentTarget.getAttribute("data-remark-index");pts.confirmModal("Delete Remark?","Are you sure you want to delete this remark?","Yes, Delete","warning",function(){pts.postJSON("/tickets/doDeleteRemark",{ticketID:a,remarkIndex:h},function(a){a.success&&p()})})},z=function(b){b.preventDefault();var h;b=parseInt(b.currentTarget.getAttribute("data-index"));var c=m[b],
d=function(a){a.preventDefault();pts.postJSON("/tickets/doUpdateRemark",a.currentTarget,function(a){a.success&&(h(),p())})};pts.openHtmlModal("ticket-editRemark",{onshow:function(b){document.getElementById("editRemark--ticketID").value=a;document.getElementById("editRemark--remarkIndex").value=c.remarkIndex;document.getElementById("editRemark--remark").value=c.remark;document.getElementById("editRemark--remarkDateString").value=c.remarkDateString;document.getElementById("editRemark--remarkTimeString").value=
c.remarkTimeString;b.getElementsByTagName("form")[0].addEventListener("submit",d)},onshown:function(a,b){h=b}})},u=function(){for(var a=n.getElementsByClassName("panel-block");0<a.length;)a[0].remove()},v=function(){u();if(0===m.length)n.insertAdjacentHTML("beforeend",'<div class="panel-block is-block"><div class="message is-info"><p class="message-body">There are no remarks associated with this ticket.</p></div></div>');else for(var a=0;a<m.length;a+=1){var c=m[a],d=document.createElement("div");
d.className="panel-block is-block";d.innerHTML='<div class="columns">'+('<div class="column"><p class="has-newline-chars">'+pts.escapeHTML(c.remark)+'</p><p class="is-size-7">'+(c.recordCreate_timeMillis===c.recordUpdate_timeMillis?"":'<i class="fas fa-pencil-alt" aria-hidden="true"></i> ')+c.recordUpdate_userName+" - "+c.remarkDateString+" "+c.remarkTimeString+"</p></div>")+(c.canUpdate?'<div class="column is-narrow"><div class="buttons is-right has-addons"><button class="button is-small is-edit-remark-button" data-tooltip="Edit Remark" data-index="'+
a+'" type="button"><span class="icon is-small"><i class="fas fa-pencil-alt" aria-hidden="true"></i></span> <span>Edit</span></button><button class="button is-small has-text-danger is-delete-remark-button" data-tooltip="Delete Remark" data-remark-index="'+c.remarkIndex+'" type="button"><i class="fas fa-trash" aria-hidden="true"></i><span class="sr-only">Delete</span></button></div></div>':"")+"</div>";c.canUpdate&&(d.getElementsByClassName("is-edit-remark-button")[0].addEventListener("click",z),d.getElementsByClassName("is-delete-remark-button")[0].addEventListener("click",
y));n.appendChild(d)}};p=function(){u();n.insertAdjacentHTML("beforeend",'<div class="panel-block is-block"><p class="has-text-centered has-text-grey-lighter"><i class="fas fa-2x fa-circle-notch fa-spin" aria-hidden="true"></i><br /><em>Loading remarks...</p></div>');pts.postJSON("/tickets/doGetRemarks",{ticketID:a},function(a){m=a;v()})};document.getElementById("is-add-remark-button").addEventListener("click",function(b){b.preventDefault();var c,d=function(a){a.preventDefault();pts.postJSON("/tickets/doAddRemark",
a.currentTarget,function(a){a.success&&(c(),p())})};pts.openHtmlModal("ticket-addRemark",{onshow:function(b){document.getElementById("addRemark--ticketID").value=a;b.getElementsByTagName("form")[0].addEventListener("submit",d)},onshown:function(a,b){c=b}})});v()}for(var e=function(a){a.preventDefault();a=a.currentTarget;var b=a.getAttribute("data-unlock"),b=a.closest(".field").getElementsByTagName(b)[0];b.removeAttribute("readonly");b.classList.remove("is-readonly");b.focus();a.setAttribute("disabled",
"disabled")},k=document.getElementsByClassName("is-unlock-field-button"),q=0;q<k.length;q+=1)k[q].addEventListener("click",e)})();
