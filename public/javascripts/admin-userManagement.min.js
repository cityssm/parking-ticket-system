"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),function(){var e=document.getElementById("is-create-user-modal");e.getElementsByTagName("form")[0].addEventListener("submit",function(e){e.preventDefault(),cityssm.postJSON("/admin/doCreateUser",e.currentTarget,function(e){e.success&&window.location.reload(!0)})}),document.getElementById("is-create-user-button").addEventListener("click",function(){cityssm.showModal(e)});for(var t=e.getElementsByClassName("is-cancel-button"),s=0;s<t.length;s+=1)t[s].addEventListener("click",cityssm.hideModal);var a=document.getElementById("container--users");function n(e){e.preventDefault();var t=e.currentTarget,s=t.getAttribute("data-user-name"),a=t.closest("tr");cityssm.confirmModal("Delete User?","Are you sure you want to delete <em>"+cityssm.escapeHTML(s)+"</em>?<br />","Yes, Delete","warning",function(){cityssm.postJSON("/admin/doDeleteUser",{userName:s},function(e){e.success&&a.remove()})})}var r=a.getElementsByClassName("is-delete-user-button");for(s=0;s<r.length;s+=1)r[s].addEventListener("click",n);var i=document.getElementById("is-update-user-modal"),d=i.getElementsByClassName("container--userName");function o(e){e.preventDefault();var t=e.currentTarget;cityssm.postJSON("/admin/doUpdateUserProperty",t,function(e){if(e.success){var s=t.getElementsByClassName("input")[0];s.classList.add("is-success"),s.classList.remove("is-danger");var a=t.getElementsByTagName("button")[0];a.classList.add("is-success"),a.classList.remove("is-danger")}})}function l(e){var t=e.currentTarget;t.classList.add("is-danger"),t.classList.remove("is-primary"),t.classList.remove("is-success");var s=t.closest(".field").getElementsByTagName("button")[0];s.classList.add("is-danger"),s.classList.remove("is-primary"),s.classList.remove("is-success")}function c(e){for(var t=e.currentTarget,s=t.getAttribute("data-user-name"),a=t.getAttribute("data-first-name"),n=t.getAttribute("data-last-name"),r=0;r<d.length;r+=1)d[r].innerText=s;document.getElementById("updateUser--userName").value=s,document.getElementById("updateUser--firstName").value=a,document.getElementById("updateUser--lastName").value=n;var c=document.getElementById("container--userProperties");cityssm.clearElement(c),cityssm.postJSON("/admin/doGetUserProperties",{userName:s},function(e){var t=0;for(var a in e)if(e.hasOwnProperty(a)){t+=1;var n=e[a],r=document.createElement("form");r.innerHTML='<input name="userName" type="hidden" value="'+s+'" /><input name="propertyName" type="hidden" value="'+a+'" /><div class="columns"><div class="column is-4"><label class="label" for="userProperties--propertyValue-'+t+'">'+a+'</label></div><div class="column"><div class="field has-addons"><div class="control is-expanded"><input class="input is-primary" id="userProperties--propertyValue-'+t+'" name="propertyValue" type="text" value="'+cityssm.escapeHTML(n)+'" placeholder="(Use Default)" /></div><div class="control"><button class="button is-outlined is-primary" type="submit">Save</button></div></div></div></div>',r.getElementsByClassName("input")[0].addEventListener("keyup",l),r.addEventListener("submit",o),c.insertAdjacentElement("beforeend",r)}}),document.getElementById("resetPassword--userName").value=s,document.getElementById("resetPassword--newPassword").closest(".message").setAttribute("hidden","hidden"),cityssm.showModal(i)}pts.initializeTabs(i.getElementsByClassName("tabs")[0].getElementsByTagName("ul")[0]);var m=a.getElementsByClassName("is-update-user-button");for(s=0;s<m.length;s+=1)m[s].addEventListener("click",c);t=i.getElementsByClassName("is-cancel-button");for(s=0;s<t.length;s+=1)t[s].addEventListener("click",cityssm.hideModal);document.getElementById("tab--updateUser-name").getElementsByTagName("form")[0].addEventListener("submit",function(e){e.preventDefault(),cityssm.postJSON("/admin/doUpdateUser",e.currentTarget,function(e){e.success&&window.location.reload(!0)})}),document.getElementById("tab--updateUser-password").getElementsByTagName("form")[0].addEventListener("submit",function(e){e.preventDefault(),cityssm.postJSON("/admin/doResetPassword",e.currentTarget,function(e){if(e.success){var t=document.getElementById("resetPassword--newPassword");t.innerText=e.newPassword,t.closest(".message").removeAttribute("hidden")}})})}();