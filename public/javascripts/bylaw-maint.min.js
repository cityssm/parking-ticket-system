"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),function(){var e=document.getElementById("bylawFilter--bylaw"),t=document.getElementById("bylawResults"),n=exports.bylaws;function a(e){e.preventDefault();var t,a=parseInt(e.currentTarget.getAttribute("data-index")),s=n[a],i=function(e){e.preventDefault(),cityssm.postJSON("/admin/doUpdateOffencesByBylaw",e.currentTarget,function(e){e.success&&(t(),n=e.bylaws,o())})};cityssm.openHtmlModal("bylaw-updateOffences",{onshow:function(){document.getElementById("updateOffences--bylawNumber").value=s.bylawNumber,document.getElementById("updateOffences--bylawDescription").value=s.bylawDescription,document.getElementById("updateOffences--offenceAmount").value=s.offenceAmountMin,document.getElementById("updateOffences--discountDays").value=s.discountDaysMin,document.getElementById("updateOffences--discountOffenceAmount").value=s.discountOffenceAmountMin},onshown:function(e,n){t=n,e.getElementsByTagName("form")[0].addEventListener("submit",i)}})}function s(e){e.preventDefault();var t,a=parseInt(e.currentTarget.getAttribute("data-index")),s=n[a],i=function(){cityssm.postJSON("/admin/doDeleteBylaw",{bylawNumber:s.bylawNumber},function(e){e.success&&(t(),n=e.bylaws,o())})},d=function(e){e.preventDefault(),cityssm.confirmModal("Delete By-Law",'Are you sure you want to remove by-law "'+s.bylawNumber+'" from the list of available options?',"Yes, Remove By-Law","danger",i)},l=function(e){e.preventDefault(),cityssm.postJSON("/admin/doUpdateBylaw",e.currentTarget,function(e){e.success&&(t(),n=e.bylaws,o())})};cityssm.openHtmlModal("bylaw-edit",{onshow:function(){document.getElementById("editBylaw--bylawNumber").value=s.bylawNumber,document.getElementById("editBylaw--bylawDescription").value=s.bylawDescription},onshown:function(e,n){t=n,e.getElementsByTagName("form")[0].addEventListener("submit",l),e.getElementsByClassName("is-delete-button")[0].addEventListener("click",d)}})}function o(){for(var o=0,i=e.value.trim().toLowerCase().split(" "),d=document.createElement("tbody"),l=0;l<n.length;l+=1){for(var c=n[l],r=!0,u=c.bylawNumber.toLowerCase(),m=c.bylawDescription.toLowerCase(),f=0;f<i.length;f+=1)if(-1===u.indexOf(i[f])&&-1===m.indexOf(i[f])){r=!1;break}if(r){o+=1;var y=document.createElement("tr"),b="",w=!1;c.offenceAmountMin?(w=!0,b="$"+c.offenceAmountMin.toFixed(2),c.offenceAmountMin!==c.offenceAmountMax&&(b+=" to $"+c.offenceAmountMax.toFixed(2)),b='<a class="has-tooltip-left" data-tooltip="Update Offence Amounts" data-index="'+l+'" href="#">'+b+"</a>"):b="(No Offences)",y.innerHTML='<td><a data-index="'+l+'" href="#">'+cityssm.escapeHTML(c.bylawNumber)+'</a></td><td class="has-border-right-width-2">'+cityssm.escapeHTML(c.bylawDescription)+'</td><td class="has-text-right">'+c.offenceCount+'</td><td class="has-text-right">'+b+"</td>",y.getElementsByTagName("a")[0].addEventListener("click",s),w&&y.getElementsByTagName("a")[1].addEventListener("click",a),d.appendChild(y)}}cityssm.clearElement(t),0!==o?(t.innerHTML='<table class="table is-striped is-hoverable is-fullwidth"><thead><tr><th>By-Law Number</th><th class="has-border-right-width-2">Description</th><th class="has-text-right">Total Offences</th><th class="has-text-right">Offence Amount Range</th></tr></thead></table>',t.getElementsByTagName("table")[0].appendChild(d)):t.innerHTML='<div class="message is-info"><div class="message-body">There are no by-laws that meet your search criteria.</div></div>'}delete exports.bylaws,e.addEventListener("keyup",o),o(),document.getElementById("is-add-bylaw-button").addEventListener("click",function(e){var t;e.preventDefault();var a=function(e){e.preventDefault(),cityssm.postJSON("/admin/doAddBylaw",e.currentTarget,function(e){e.success?(t(),e.message&&cityssm.alertModal("By-Law Added",e.message,"OK","warning"),n=e.bylaws,o()):cityssm.alertModal("By-Law Not Added",e.message,"OK","danger")})};cityssm.openHtmlModal("bylaw-add",{onshown:function(e,n){t=n,e.getElementsByTagName("form")[0].addEventListener("submit",a)}})})}();