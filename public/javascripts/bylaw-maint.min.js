(function(){function n(d){d.preventDefault();d=parseInt(d.currentTarget.getAttribute("data-index"));var b=h[d],e,c=function(){pts.postJSON("/admin/doDeleteBylaw",{bylawNumber:b.bylawNumber},function(a){a.success&&(e(),h=a.bylaws,f())})},a=function(a){a.preventDefault();pts.confirmModal("Delete By-Law",'Are you sure you want to by-law "'+b.bylawNumber+'" from the list of available options?',"Yes, Remove By-Law","danger",c)},g=function(a){a.preventDefault();pts.postJSON("/admin/doUpdateBylaw",a.currentTarget,
function(a){a.success&&(e(),h=a.bylaws,f())})};pts.openHtmlModal("bylaw-edit",{onshow:function(){document.getElementById("editBylaw--bylawNumber").value=b.bylawNumber;document.getElementById("editBylaw--bylawDescription").value=b.bylawDescription},onshown:function(b,c){e=c;b.getElementsByTagName("form")[0].addEventListener("submit",g);b.getElementsByClassName("is-delete-button")[0].addEventListener("click",a)}})}var m=document.getElementById("bylawFilter--bylaw"),k=document.getElementById("bylawResults"),
f,h=pts.bylawsInit;delete pts.bylawsInit;f=function(){for(var d=0,b=m.value.trim().toLowerCase().split(" "),e=document.createElement("tbody"),c=0;c<h.length;c+=1){for(var a=h[c],g=!0,f=a.bylawNumber.toLowerCase(),p=a.bylawDescription.toLowerCase(),l=0;l<b.length;l+=1)if(-1===f.indexOf(b[l])&&-1===p.indexOf(b[l])){g=!1;break}g&&(d+=1,g=document.createElement("tr"),g.innerHTML='<td><a data-index="'+c+'" href="#">'+pts.escapeHTML(a.bylawNumber)+"</a></td><td>"+pts.escapeHTML(a.bylawDescription)+"</td>",
g.getElementsByTagName("a")[0].addEventListener("click",n),e.appendChild(g))}pts.clearElement(k);0===d?k.innerHTML='<div class="message is-info"><div class="message-body">There are no by-laws that meet your search criteria.</div></div>':(k.innerHTML='<table class="table is-striped is-hoverable is-fullwidth"><thead><tr><th>By-Law Number</th><th>Description</th></tr></thead></table>',k.getElementsByTagName("table")[0].appendChild(e))};m.addEventListener("keyup",f);f();document.getElementById("is-add-bylaw-button").addEventListener("click",
function(d){d.preventDefault();var b,e=function(c){c.preventDefault();pts.postJSON("/admin/doAddBylaw",c.currentTarget,function(a){a.success?(b(),a.message&&pts.alertModal("By-Law Added",a.message,"OK","warning"),h=a.bylaws,f()):pts.alertModal("By-Law Not Added",a.message,"OK","danger")})};pts.openHtmlModal("bylaw-add",{onshown:function(c,a){b=a;c.getElementsByTagName("form")[0].addEventListener("submit",e)}})})})();
