"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),(()=>{let e="";const t=document.getElementById("locationFilter--locationClassKey"),o=document.getElementById("locationFilter--locationName"),a=document.getElementById("locationResults"),n=new Map;let s=exports.locations;delete exports.locations;const i=t=>{t.preventDefault();const o=parseInt(t.currentTarget.getAttribute("data-index"),10),a=s[o];let i;const c=()=>{cityssm.postJSON("/admin/doDeleteLocation",{locationKey:a.locationKey},e=>{e.success&&(i(),s=e.locations,l())})},d=e=>{e.preventDefault(),cityssm.confirmModal("Delete Location",'Are you sure you want to remove "'+a.locationName+'" from the list of available options?',"Yes, Remove Location","danger",c)},r=e=>{e.preventDefault(),cityssm.postJSON("/admin/doUpdateLocation",e.currentTarget,e=>{e.success&&(i(),s=e.locations,l())})};cityssm.openHtmlModal("location-edit",{onshow(){document.getElementById("editLocation--locationKey").value=a.locationKey;const t=document.getElementById("editLocation--locationClassKey");t.innerHTML=e,n.has(a.locationClassKey)||t.insertAdjacentHTML("beforeend",'<option value="'+cityssm.escapeHTML(a.locationClassKey)+'">'+cityssm.escapeHTML(a.locationClassKey)+"</option>"),t.value=a.locationClassKey,document.getElementById("editLocation--locationName").value=a.locationName},onshown(e,t){i=t,document.getElementById("form--editLocation").addEventListener("submit",r),e.getElementsByClassName("is-delete-button")[0].addEventListener("click",d)}})},l=()=>{let e=0;const l=t.value,c=o.value.trim().toLowerCase().split(" "),d=document.createElement("tbody");s.forEach((t,o)=>{if(""!==l&&l!==t.locationClassKey)return;let a=!0;const s=t.locationName.toLowerCase();for(const e of c)if(-1===s.indexOf(e)){a=!1;break}if(!a)return;e+=1;const r=n.has(t.locationClassKey)?n.get(t.locationClassKey).locationClass:t.locationClassKey,m=document.createElement("tr");m.innerHTML='<td><a data-index="'+o+'" href="#">'+cityssm.escapeHTML(t.locationName)+"</a></td><td>"+cityssm.escapeHTML(r)+"</td>",m.getElementsByTagName("a")[0].addEventListener("click",i),d.appendChild(m)}),cityssm.clearElement(a),0!==e?(a.innerHTML='<table class="table is-fixed is-striped is-hoverable is-fullwidth"><thead><tr><th>Location</th><th>Class</th></tr></thead></table>',a.getElementsByTagName("table")[0].appendChild(d)):a.innerHTML='<div class="message is-info"><div class="message-body">There are no locations that meet your search criteria.</div></div>'};t.addEventListener("change",l),o.addEventListener("keyup",l),pts.getDefaultConfigProperty("locationClasses",o=>{t.innerHTML='<option value="">(All Location Classes)</option>';for(const t of o)e+='<option value="'+t.locationClassKey+'">'+cityssm.escapeHTML(t.locationClass)+"</option>",n.set(t.locationClassKey,t);t.insertAdjacentHTML("beforeend",e),l()}),document.getElementById("is-add-location-button").addEventListener("click",t=>{let o;t.preventDefault();const a=function(e){e.preventDefault(),cityssm.postJSON("/admin/doAddLocation",e.currentTarget,e=>{e.success?(o(),s=e.locations,l()):cityssm.alertModal("Location Not Added",e.message,"OK","danger")})};cityssm.openHtmlModal("location-add",{onshown(t,n){o=n,document.getElementById("addLocation--locationClassKey").insertAdjacentHTML("beforeend",e),document.getElementById("form--addLocation").addEventListener("submit",a)}})})})();