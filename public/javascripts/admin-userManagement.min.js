(function(){function l(a){a.preventDefault();var d=a.currentTarget.getAttribute("data-user-name"),g=a.currentTarget.closest("tr");cityssm.confirmModal("Delete User?","Are you sure you want to delete <em>"+cityssm.escapeHTML(d)+"</em>?<br />","Yes, Delete","warning",function(){cityssm.postJSON("/admin/doDeleteUser",{userName:d},function(a){a.success&&g.remove()})})}function m(a){a.preventDefault();var d=a.currentTarget;cityssm.postJSON("/admin/doUpdateUserProperty",d,function(a){a.success&&(a=d.getElementsByClassName("input")[0],
a.classList.add("is-success"),a.classList.remove("is-danger"),a=d.getElementsByTagName("button")[0],a.classList.add("is-success"),a.classList.remove("is-danger"))})}function n(a){a=a.currentTarget;a.classList.add("is-danger");a.classList.remove("is-primary");a.classList.remove("is-success");a=a.closest(".field").getElementsByTagName("button")[0];a.classList.add("is-danger");a.classList.remove("is-primary");a.classList.remove("is-success")}function p(a){var d=a.currentTarget,c=d.getAttribute("data-user-name");
a=d.getAttribute("data-first-name");for(var d=d.getAttribute("data-last-name"),b=0;b<k.length;b+=1)k[b].innerText=c;document.getElementById("updateUser--userName").value=c;document.getElementById("updateUser--firstName").value=a;document.getElementById("updateUser--lastName").value=d;var f=document.getElementById("container--userProperties");cityssm.clearElement(f);cityssm.postJSON("/admin/doGetUserProperties",{userName:c},function(a){var d=0,b;for(b in a)if(a.hasOwnProperty(b)){var d=d+1,g=a[b],
e=document.createElement("form");e.innerHTML='<input name="userName" type="hidden" value="'+c+'" /><input name="propertyName" type="hidden" value="'+b+'" /><div class="columns">'+('<div class="column is-4"><label class="label" for="userProperties--propertyValue-'+d+'">'+b+"</label></div>")+('<div class="column"><div class="field has-addons"><div class="control is-expanded">'+('<input class="input is-primary" id="userProperties--propertyValue-'+d+'" name="propertyValue" type="text" value="'+cityssm.escapeHTML(g)+
'" placeholder="(Use Default)" />')+'</div><div class="control"><button class="button is-outlined is-primary" type="submit">Save</button></div></div></div>')+"</div>";e.getElementsByClassName("input")[0].addEventListener("keyup",n);e.addEventListener("submit",m);f.insertAdjacentElement("beforeend",e)}});document.getElementById("resetPassword--userName").value=c;document.getElementById("resetPassword--newPassword").closest(".message").setAttribute("hidden","hidden");cityssm.showModal(e)}var f=document.getElementById("is-create-user-modal");
f.getElementsByTagName("form")[0].addEventListener("submit",function(a){a.preventDefault();cityssm.postJSON("/admin/doCreateUser",a.currentTarget,function(a){a.success&&window.location.reload(!0)})});document.getElementById("is-create-user-button").addEventListener("click",function(){cityssm.showModal(f)});for(var b=f.getElementsByClassName("is-cancel-button"),c=0;c<b.length;c+=1)b[c].addEventListener("click",cityssm.hideModal);for(var b=document.getElementById("container--users"),c=b.getElementsByClassName("is-delete-user-button"),
h=0;h<c.length;h+=1)c[h].addEventListener("click",l);var e=document.getElementById("is-update-user-modal"),k=e.getElementsByClassName("container--userName");pts.initializeTabs(e.getElementsByClassName("tabs")[0].getElementsByTagName("ul")[0]);b=b.getElementsByClassName("is-update-user-button");for(c=0;c<b.length;c+=1)b[c].addEventListener("click",p);b=e.getElementsByClassName("is-cancel-button");for(c=0;c<b.length;c+=1)b[c].addEventListener("click",cityssm.hideModal);document.getElementById("tab--updateUser-name").getElementsByTagName("form")[0].addEventListener("submit",
function(a){a.preventDefault();cityssm.postJSON("/admin/doUpdateUser",a.currentTarget,function(a){a.success&&window.location.reload(!0)})});document.getElementById("tab--updateUser-password").getElementsByTagName("form")[0].addEventListener("submit",function(a){a.preventDefault();cityssm.postJSON("/admin/doResetPassword",a.currentTarget,function(a){if(a.success){var b=document.getElementById("resetPassword--newPassword");b.innerText=a.newPassword;b.closest(".message").removeAttribute("hidden")}})})})();
