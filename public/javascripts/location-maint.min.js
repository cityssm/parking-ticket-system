"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),(()=>{var e;let t="";const o=document.querySelector("#locationFilter--locationClassKey"),n=document.querySelector("#locationFilter--locationName"),a=document.querySelector("#locationResults");let i=exports.locations;function s(e){var o;e.preventDefault();const n=Number.parseInt(null!==(o=e.currentTarget.dataset.index)&&void 0!==o?o:"-1",10),a=i[n];let s;function c(){cityssm.postJSON("/admin/doDeleteLocation",{locationKey:a.locationKey},e=>{e.success&&(s(),i=e.locations,l())})}function r(e){e.preventDefault(),cityssm.confirmModal("Delete Location",`Are you sure you want to remove "${a.locationName}" from the list of available options?`,"Yes, Remove Location","danger",c)}function d(e){e.preventDefault(),cityssm.postJSON("/admin/doUpdateLocation",e.currentTarget,e=>{e.success&&(s(),i=e.locations,l())})}cityssm.openHtmlModal("location-edit",{onshow(){document.querySelector("#editLocation--locationKey").value=a.locationKey;const e=document.querySelector("#editLocation--locationClassKey");e.innerHTML=t,e.querySelector("[value='"+a.locationClassKey+"']")||e.insertAdjacentHTML("beforeend",'<option value="'+cityssm.escapeHTML(a.locationClassKey)+'">'+cityssm.escapeHTML(a.locationClassKey)+"</option>"),e.value=a.locationClassKey,document.querySelector("#editLocation--locationName").value=a.locationName},onshown(e,t){var o,n;bulmaJS.toggleHtmlClipped(),s=t,null===(o=document.querySelector("#form--editLocation"))||void 0===o||o.addEventListener("submit",d),null===(n=e.querySelector(".is-delete-button"))||void 0===n||n.addEventListener("click",r)},onhidden(){bulmaJS.toggleHtmlClipped()}})}function l(){let e=0;const t=o.value,l=n.value.trim().toLowerCase().split(" "),c=document.createElement("tbody");for(const[o,n]of i.entries()){if(""!==t&&t!==n.locationClassKey)continue;let a=!0;const i=n.locationName.toLowerCase();for(const e of l)if(!i.includes(e)){a=!1;break}if(!a)continue;e+=1;const r=pts.getLocationClass(n.locationClassKey).locationClass,d=document.createElement("tr");d.innerHTML='<td><a data-index="'+o.toString()+'" href="#">'+cityssm.escapeHTML(n.locationName)+"</a></td><td>"+cityssm.escapeHTML(r)+"</td>",d.querySelector("a").addEventListener("click",s),c.append(d)}cityssm.clearElement(a),0!==e?(a.innerHTML='<table class="table is-fixed is-striped is-hoverable is-fullwidth"><thead><tr><th>Location</th><th>Class</th></tr></thead></table>',a.querySelector("table").append(c)):a.innerHTML='<div class="message is-info"><div class="message-body">There are no locations that meet your search criteria.</div></div>'}delete exports.locations,o.addEventListener("change",l),n.addEventListener("keyup",l),pts.getDefaultConfigProperty("locationClasses",e=>{o.innerHTML='<option value="">(All Location Classes)</option>';for(const o of e)t+=`<option value="${o.locationClassKey}">\n          ${cityssm.escapeHTML(o.locationClass)}\n          </option>`;o.insertAdjacentHTML("beforeend",t),l()}),null===(e=document.querySelector("#is-add-location-button"))||void 0===e||e.addEventListener("click",e=>{let o;e.preventDefault();const n=e=>{e.preventDefault(),cityssm.postJSON("/admin/doAddLocation",e.currentTarget,e=>{var t;e.success?(o(),i=e.locations,l()):cityssm.alertModal("Location Not Added",null!==(t=e.message)&&void 0!==t?t:"","OK","danger")})};cityssm.openHtmlModal("location-add",{onshown(e,a){var i,s;o=a,null===(i=document.querySelector("#addLocation--locationClassKey"))||void 0===i||i.insertAdjacentHTML("beforeend",t),null===(s=document.querySelector("#form--addLocation"))||void 0===s||s.addEventListener("submit",n)}})})})();