"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),(()=>{let e="";const t=document.querySelector("#form--filters"),i=document.querySelector("#filter--offset"),s=document.querySelector("#container--searchResults"),a=e=>{const t=document.createElement("tr"),i=pts.getLicencePlateLocationProperties(e.licencePlateCountry,e.licencePlateProvince);let s="";e.locationClassKey&&(s=pts.getLocationClass(e.locationClassKey).locationClass);const a=pts.getTicketStatus(e.latestStatus_statusKey);return t.innerHTML='<td><a href="/tickets/'+e.ticketID.toString()+'" data-tooltip="View Parking Ticket">'+e.ticketNumber+'</a></td><td class="is-nowrap">'+e.issueDateString+'</td><td><div class="licence-plate is-fullwidth" style="--color:'+i.licencePlateProvince.color+";--backgroundColor:"+i.licencePlateProvince.backgroundColor+'"><div class="licence-plate-province">'+i.licencePlateProvinceAlias+'</div><div class="licence-plate-number">'+(""===e.licencePlateNumber?'<i class="fas fa-question-circle has-opacity-2" aria-hidden="true"></i>':cityssm.escapeHTML(e.licencePlateNumber))+"</div></div></td><td>"+(e.locationDescription?`${e.locationDescription}<br />`:"")+(e.locationKey&&""!==e.locationKey&&e.locationName?`<small class="has-tooltip-right" data-tooltip="${s}">\n              <i class="fas fa-map-marker-alt" aria-hidden="true"></i>\n              ${cityssm.escapeHTML(e.locationName)}\n              </small>`:"")+"</td><td>"+cityssm.escapeHTML(e.parkingOffence)+"</td><td>"+(""===e.resolvedDateString?"Unresolved":'<span class="sr-only">Resolved</span><i class="fas fa-check" aria-hidden="true"></i> '+e.resolvedDateString)+(e.latestStatus_statusKey?'<br /><span class="tag is-light is-primary">'+a.status+"</span>":"")+"</td>",t},n=t=>{const n=t.tickets;if(0===n.length)return void(s.innerHTML='<div class="message is-info"><div class="message-body"><strong>Your search returned no results.</strong><br />Please try expanding your search criteria.</div></div>');s.innerHTML='<table class="table is-fullwidth is-striped is-hoverable"><thead><tr><th>'+cityssm.escapeHTML(e)+"</th><th>Issue Date</th><th>Plate Number</th><th>Location</th><th>Offence</th><th>Status</th></tr></thead><tbody></tbody></table>";const l=s.querySelector("tbody");for(const e of n){const t=a(e);l.append(t)}if(s.insertAdjacentHTML("beforeend",'<div class="level is-block-print"><div class="level-left has-text-weight-bold">Displaying parking tickets '+(t.offset+1).toString()+" to "+Math.min(t.limit+t.offset,t.count).toString()+" of "+t.count.toString()+"</div></div>"),t.limit<t.count){const e=document.createElement("nav");if(e.className="level-right is-hidden-print",e.setAttribute("role","pagination"),e.setAttribute("aria-label","pagination"),t.offset>0){const a=document.createElement("a");a.className="button",a.textContent="Previous",a.addEventListener("click",e=>{e.preventDefault(),i.value=Math.max(0,t.offset-t.limit).toString(),s.scrollIntoView(!0),c()}),e.append(a)}if(t.limit+t.offset<t.count){const a=document.createElement("a");a.className="button ml-3",a.innerHTML='<span>Next Tickets</span><span class="icon"><i class="fas fa-chevron-right" aria-hidden="true"></i></span>',a.addEventListener("click",e=>{e.preventDefault(),i.value=(t.offset+t.limit).toString(),s.scrollIntoView(!0),c()}),e.append(a)}s.querySelectorAll(".level")[0].append(e)}},c=()=>{cityssm.clearElement(s),s.innerHTML='<p class="has-text-centered has-text-grey-light"><i class="fas fa-3x fa-circle-notch fa-spin" aria-hidden="true"></i><br /><em>Loading tickets...</p>',cityssm.postJSON("/tickets/doGetTickets",t,n)},l=()=>{i.value="0",c()};t.addEventListener("submit",e=>{e.preventDefault()}),document.querySelector("#filter--ticketNumber").addEventListener("change",l),document.querySelector("#filter--licencePlateNumber").addEventListener("change",l),document.querySelector("#filter--location").addEventListener("change",l),document.querySelector("#filter--isResolved").addEventListener("change",l),pts.getDefaultConfigProperty("ticketNumber_fieldLabel",t=>{e=t,pts.getDefaultConfigProperty("locationClasses",c)})})();