(function(){function n(a){a.preventDefault();a=a.currentTarget.getAttribute("data-ticket-id");cityssm.postJSON("/tickets/doAddTicketToConvictionBatch",{batchID:h,ticketID:a},function(a){})}function p(a){a.preventDefault();cityssm.postJSON("/tickets/doAddAllTicketsToConvictionBatch",{batchID:h,ticketIDs:c},function(a){})}function l(){cityssm.clearElement(d);c=[];if(0===e.length)d.innerHTML='<div class="message is-info"><div class="message-body">There are no parking tickets currently eligible for conviction.</div></div>';
else{for(var a=m.value.trim().toLowerCase(),k=document.createElement("tbody"),f=0;f<e.length;f+=1){var b=e[f];if(-1!==b.ticketNumber.toLowerCase().indexOf(a)||-1!==b.licencePlateNumber.toLowerCase().indexOf(a)){c.push(b.ticketID);var g=document.createElement("tr");g.innerHTML='<td><a data-tooltip="View Ticket (Opens in New Window)" href="/tickets/'+b.ticketID+'" target="_blank">'+cityssm.escapeHTML(b.ticketNumber)+"</a></td>"+('<td><span class="licence-plate-number is-size-6">'+cityssm.escapeHTML(b.licencePlateNumber)+
'</span><br /><span class="has-tooltip-right is-size-7" data-tooltip="Primary Owner">'+cityssm.escapeHTML(b.ownerName1)+"</span></td>")+"<td>"+b.issueDateString+"</td>"+('<td class="has-text-right"><button class="button is-small" data-ticket-id="'+b.ticketID+'" type="button"><span class="icon is-small"><i class="fas fa-plus" aria-hidden="true"></i></span><span>Add</span></button></td>');g.getElementsByTagName("button")[0].addEventListener("click",n);k.appendChild(g)}}0===c.length?d.innerHTML='<div class="message is-info"><div class="message-body">There are no parking tickets that meet the search criteria.</div></div>':
(a=document.createElement("button"),a.className="button is-fullwidth has-margin-bottom-10",a.innerHTML='<span class="icon is-small"><i class="fas fa-plus" aria-hidden="true"></i></span><span>Add '+c.length+" Parking Ticket"+(1===c.length?"":"s")+"</span>",a.addEventListener("click",p),d.appendChild(a),a=document.createElement("table"),a.className="table is-striped is-hoverable is-fullwidth",a.innerHTML="<thead><tr><th>Ticket Number</th><th>Licence Plate</th><th>Issue Date</th><th></th></tr></thead>",
a.appendChild(k),d.appendChild(a))}}var m=document.getElementById("filter--parkingTicket"),d=document.getElementById("is-convictable-tickets-container"),h,e=pts.convictableTicketsInit;delete pts.convictableTicketsInit;var c=[];l();m.addEventListener("keyup",l);document.getElementById("is-select-batch-button").addEventListener("click",function(a){a.preventDefault();cityssm.openHtmlModal("mto-selectBatch",{onShown:function(a,c){}})})})();
