var $jscomp={scope:{}};$jscomp.defineProperty="function"==typeof Object.defineProperties?Object.defineProperty:function(a,e,b){if(b.get||b.set)throw new TypeError("ES3 does not support getters and setters.");a!=Array.prototype&&a!=Object.prototype&&(a[e]=b.value)};$jscomp.getGlobal=function(a){return"undefined"!=typeof window&&window===a?a:"undefined"!=typeof global&&null!=global?global:a};$jscomp.global=$jscomp.getGlobal(this);$jscomp.SYMBOL_PREFIX="jscomp_symbol_";
$jscomp.initSymbol=function(){$jscomp.initSymbol=function(){};$jscomp.global.Symbol||($jscomp.global.Symbol=$jscomp.Symbol)};$jscomp.symbolCounter_=0;$jscomp.Symbol=function(a){return $jscomp.SYMBOL_PREFIX+(a||"")+$jscomp.symbolCounter_++};
$jscomp.initSymbolIterator=function(){$jscomp.initSymbol();var a=$jscomp.global.Symbol.iterator;a||(a=$jscomp.global.Symbol.iterator=$jscomp.global.Symbol("iterator"));"function"!=typeof Array.prototype[a]&&$jscomp.defineProperty(Array.prototype,a,{configurable:!0,writable:!0,value:function(){return $jscomp.arrayIterator(this)}});$jscomp.initSymbolIterator=function(){}};$jscomp.arrayIterator=function(a){var e=0;return $jscomp.iteratorPrototype(function(){return e<a.length?{done:!1,value:a[e++]}:{done:!0}})};
$jscomp.iteratorPrototype=function(a){$jscomp.initSymbolIterator();a={next:a};a[$jscomp.global.Symbol.iterator]=function(){return this};return a};$jscomp.makeIterator=function(a){$jscomp.initSymbolIterator();var e=a[Symbol.iterator];return e?e.call(a):$jscomp.arrayIterator(a)};$jscomp.owns=function(a,e){return Object.prototype.hasOwnProperty.call(a,e)};
$jscomp.polyfill=function(a,e,b,d){if(e){b=$jscomp.global;a=a.split(".");for(d=0;d<a.length-1;d++){var h=a[d];h in b||(b[h]={});b=b[h]}a=a[a.length-1];d=b[a];e=e(d);e!=d&&null!=e&&$jscomp.defineProperty(b,a,{configurable:!0,writable:!0,value:e})}};
$jscomp.polyfill("WeakMap",function(a){function e(a){$jscomp.owns(a,d)||$jscomp.defineProperty(a,d,{value:{}})}function b(a){var c=Object[a];c&&(Object[a]=function(a){e(a);return c(a)})}if(function(){if(!a||!Object.seal)return!1;try{var b=Object.seal({}),c=Object.seal({}),p=new a([[b,2],[c,3]]);if(2!=p.get(b)||3!=p.get(c))return!1;p["delete"](b);p.set(c,4);return!p.has(b)&&4==p.get(c)}catch(k){return!1}}())return a;var d="$jscomp_hidden_"+Math.random().toString().substring(2);b("freeze");b("preventExtensions");
b("seal");var h=0,l=function(a){this.id_=(h+=Math.random()+1).toString();if(a){$jscomp.initSymbol();$jscomp.initSymbolIterator();a=$jscomp.makeIterator(a);for(var c;!(c=a.next()).done;)c=c.value,this.set(c[0],c[1])}};l.prototype.set=function(a,c){e(a);if(!$jscomp.owns(a,d))throw Error("WeakMap key fail: "+a);a[d][this.id_]=c;return this};l.prototype.get=function(a){return $jscomp.owns(a,d)?a[d][this.id_]:void 0};l.prototype.has=function(a){return $jscomp.owns(a,d)&&$jscomp.owns(a[d],this.id_)};l.prototype["delete"]=
function(a){return $jscomp.owns(a,d)&&$jscomp.owns(a[d],this.id_)?delete a[d][this.id_]:!1};return l},"es6-impl","es3");$jscomp.ASSUME_NO_NATIVE_MAP=!1;
$jscomp.polyfill("Map",function(a){if(!$jscomp.ASSUME_NO_NATIVE_MAP&&function(){if(!a||!a.prototype.entries||"function"!=typeof Object.seal)return!1;try{var c=Object.seal({x:4}),b=new a($jscomp.makeIterator([[c,"s"]]));if("s"!=b.get(c)||1!=b.size||b.get({x:4})||b.set({x:4},"t")!=b||2!=b.size)return!1;var k=b.entries(),d=k.next();if(d.done||d.value[0]!=c||"s"!=d.value[1])return!1;d=k.next();return d.done||4!=d.value[0].x||"t"!=d.value[1]||!k.next().done?!1:!0}catch(F){return!1}}())return a;$jscomp.initSymbol();
$jscomp.initSymbolIterator();var e=new WeakMap,b=function(a){this.data_={};this.head_=l();this.size=0;if(a){a=$jscomp.makeIterator(a);for(var c;!(c=a.next()).done;)c=c.value,this.set(c[0],c[1])}};b.prototype.set=function(a,b){var c=d(this,a);c.list||(c.list=this.data_[c.id]=[]);c.entry?c.entry.value=b:(c.entry={next:this.head_,previous:this.head_.previous,head:this.head_,key:a,value:b},c.list.push(c.entry),this.head_.previous.next=c.entry,this.head_.previous=c.entry,this.size++);return this};b.prototype["delete"]=
function(a){a=d(this,a);return a.entry&&a.list?(a.list.splice(a.index,1),a.list.length||delete this.data_[a.id],a.entry.previous.next=a.entry.next,a.entry.next.previous=a.entry.previous,a.entry.head=null,this.size--,!0):!1};b.prototype.clear=function(){this.data_={};this.head_=this.head_.previous=l();this.size=0};b.prototype.has=function(a){return!!d(this,a).entry};b.prototype.get=function(a){return(a=d(this,a).entry)&&a.value};b.prototype.entries=function(){return h(this,function(a){return[a.key,
a.value]})};b.prototype.keys=function(){return h(this,function(a){return a.key})};b.prototype.values=function(){return h(this,function(a){return a.value})};b.prototype.forEach=function(a,b){for(var c=this.entries(),d;!(d=c.next()).done;)d=d.value,a.call(b,d[1],d[0],this)};b.prototype[Symbol.iterator]=b.prototype.entries;var d=function(a,b){var c;c=b&&typeof b;"object"==c||"function"==c?e.has(b)?c=e.get(b):(c=""+ ++B,e.set(b,c)):c="p_"+b;var d=a.data_[c];if(d&&$jscomp.owns(a.data_,c))for(var h=0;h<
d.length;h++){var m=d[h];if(b!==b&&m.key!==m.key||b===m.key)return{id:c,list:d,index:h,entry:m}}return{id:c,list:d,index:-1,entry:void 0}},h=function(a,b){var c=a.head_;return $jscomp.iteratorPrototype(function(){if(c){for(;c.head!=a.head_;)c=c.previous;for(;c.next!=c.head;)return c=c.next,{done:!1,value:b(c)};c=null}return{done:!0,value:void 0}})},l=function(){var a={};return a.previous=a.next=a.head=a},B=0;return b},"es6-impl","es3");$jscomp.array=$jscomp.array||{};
$jscomp.iteratorFromArray=function(a,e){$jscomp.initSymbolIterator();a instanceof String&&(a+="");var b=0,d={next:function(){if(b<a.length){var h=b++;return{value:e(h,a[h]),done:!1}}d.next=function(){return{done:!0,value:void 0}};return d.next()}};d[Symbol.iterator]=function(){return d};return d};$jscomp.polyfill("Array.prototype.values",function(a){return a?a:function(){return $jscomp.iteratorFromArray(this,function(a,b){return b})}},"es6","es3");
(function(){function a(a,b){return a+"::::"+b}function e(b){w.clear();for(var c=0;c<b.length;c+=1){var q=b[c],d=a(q.bylawNumber,q.locationKey);w.set(d,q)}}function b(b){b.preventDefault();b=b.currentTarget;b=a(b.getAttribute("data-bylaw-number"),b.getAttribute("data-location-key"));var c=w.get(b),q=m.get(c.locationKey),d=r.get(c.bylawNumber),f,g=function(){cityssm.postJSON("/admin/doDeleteOffence",{bylawNumber:c.bylawNumber,locationKey:c.locationKey},function(a){a.success&&(e(a.offences),f(),n())})},
I=function(a){a.preventDefault();pts.confirmModal("Remove Offence?","Are you sure you want to remove this offence?","Yes, Remove Offence","warning",g)},H=function(a){a.preventDefault();cityssm.postJSON("/admin/doUpdateOffence",a.currentTarget,function(a){a.success&&(e(a.offences),f(),n())})};cityssm.openHtmlModal("offence-edit",{onshow:function(){document.getElementById("offenceEdit--locationKey").value=c.locationKey;document.getElementById("offenceEdit--bylawNumber").value=c.bylawNumber;document.getElementById("offenceEdit--locationName").innerText=
q.locationName;document.getElementById("offenceEdit--locationClass").innerText=k.has(q.locationClassKey)?k.get(q.locationClassKey).locationClass:q.locationClassKey;document.getElementById("offenceEdit--bylawNumberSpan").innerText=d.bylawNumber;document.getElementById("offenceEdit--bylawDescription").innerText=d.bylawDescription;document.getElementById("offenceEdit--parkingOffence").value=c.parkingOffence;document.getElementById("offenceEdit--offenceAmount").value=c.offenceAmount;var a=document.getElementById("offenceEdit--accountNumber");
a.value=c.accountNumber;a.setAttribute("pattern",F)},onshown:function(a,b){f=b;document.getElementById("form--offenceEdit").addEventListener("submit",H);a.getElementsByClassName("is-delete-button")[0].addEventListener("click",I)}})}function d(a,b,c,d){cityssm.postJSON("/admin/doAddOffence",{bylawNumber:a,locationKey:b,returnOffences:c},function(a){a.success&&a.offences&&c&&(e(a.offences),n());d&&d(a)})}function h(){var b=!1,c=function(a){a.preventDefault();var c=a.currentTarget;a=c.getAttribute("data-bylaw-number");
var f=c.getAttribute("data-location-key");d(a,f,!1,function(a){a.success&&(c.remove(),b=!0)})};cityssm.openHtmlModal("offence-addFromList",{onshow:function(a){var c,b;if(t){c="Select By-Laws";b=m.get(u);var d=k.get(b.locationClassKey);b=cityssm.escapeHTML(b.locationName)+'<br /><span class="is-size-7">'+cityssm.escapeHTML(d?d.locationClass:b.locationClassKey)+"</span>"}else c="Select Locations",b=r.get(v),b=cityssm.escapeHTML(b.bylawNumber)+'<br /><span class="is-size-7">'+b.bylawDescription+"</span>";
a.getElementsByClassName("modal-card-title")[0].innerHTML=c;document.getElementById("addContainer--selected").innerHTML=b},onshown:function(){var b=document.createElement("div");b.className="list has-margin-bottom-20";var d=0;if(t)for(var f=$jscomp.makeIterator(r.values()),g=f.next();!g.done;g=f.next()){var g=g.value,e=a(g.bylawNumber,u);w.has(e)||(d+=1,e=document.createElement("a"),e.className="list-item",e.setAttribute("data-bylaw-number",g.bylawNumber),e.setAttribute("data-location-key",u),e.innerHTML=
cityssm.escapeHTML(g.bylawNumber)+'<br /><span class="is-size-7">'+cityssm.escapeHTML(g.bylawDescription)+"</span>",e.addEventListener("click",c),b.appendChild(e))}else for(f=$jscomp.makeIterator(m.values()),g=f.next();!g.done;g=f.next())g=g.value,e=a(v,g.locationKey),w.has(e)||(d+=1,e=document.createElement("a"),e.className="list-item",e.setAttribute("data-bylaw-number",v),e.setAttribute("data-location-key",g.locationKey),e.innerHTML=cityssm.escapeHTML(g.locationName)+'<br /><span class="is-size-7">'+
(k.has(g.locationClassKey)?cityssm.escapeHTML(k.get(g.locationClassKey).locationClass):g.locationClassKey)+"</span>",e.addEventListener("click",c),b.appendChild(e));f=document.getElementById("addContainer--results");cityssm.clearElement(f);0===d?f.innerHTML='<div class="message is-info"><div class="message-body">There are no offence records available for creation.</div></div>':f.appendChild(b)},onremoved:function(){b&&cityssm.postJSON("/offences/doGetAllOffences",{},function(a){e(a);n()})}})}function l(){C.value=
"";cityssm.clearElement(J);u="";t=!1}function B(){var a,b=function(b){b.preventDefault();b=m.get(b.currentTarget.getAttribute("data-location-key"));t=!0;u=b.locationKey;C.value=b.locationName;a();n()};cityssm.openHtmlModal("location-select",{onshow:function(){var a=document.createElement("div");a.className="list is-hoverable has-margin-bottom-20";for(var c=$jscomp.makeIterator(m.values()),d=c.next();!d.done;d=c.next()){var d=d.value,e=document.createElement("a");e.className="list-item";e.setAttribute("data-location-key",
d.locationKey);e.setAttribute("href","#");e.innerHTML='<div class="level">'+('<div class="level-left">'+cityssm.escapeHTML(d.locationName)+"</div>")+'<div class="level-right">'+cityssm.escapeHTML(k.has(d.locationClassKey)?k.get(d.locationClassKey).locationClass:d.locationClassKey)+"</div></div>";e.addEventListener("click",b);a.appendChild(e)}c=document.getElementById("container--parkingLocations");cityssm.clearElement(c);c.appendChild(a)},onshown:function(b,c){a=c}})}function c(){D.value="";cityssm.clearElement(G);
v="";y=!1}function p(){var a,b=function(b){b.preventDefault();b=r.get(b.currentTarget.getAttribute("data-bylaw-number"));y=!0;v=b.bylawNumber;D.value=b.bylawNumber;G.innerText=b.bylawDescription;a();n()};cityssm.openHtmlModal("bylaw-select",{onshow:function(){var a=document.createElement("div");a.className="list is-hoverable has-margin-bottom-20";for(var c=$jscomp.makeIterator(r.values()),d=c.next();!d.done;d=c.next()){var d=d.value,e=document.createElement("a");e.className="list-item";e.setAttribute("data-bylaw-number",
d.bylawNumber);e.setAttribute("href","#");e.innerHTML=cityssm.escapeHTML(d.bylawNumber)+'<br /><span class="is-size-7">'+cityssm.escapeHTML(d.bylawDescription)+"</span>";e.addEventListener("click",b);a.appendChild(e)}c=document.getElementById("container--parkingBylaws");cityssm.clearElement(c);c.appendChild(a)},onshown:function(b,c){a=c}})}var k=new Map,w=new Map,F=pts.accountNumberPatternInit;delete pts.accountNumberPatternInit;var m=new Map,E=document.getElementById("offenceFilter--limitResults"),
z=document.getElementById("offenceResults"),C=document.getElementById("offenceFilter--location"),J=document.getElementById("offenceFilter--locationText"),t=!1,u="",r=new Map,D=document.getElementById("offenceFilter--bylaw"),G=document.getElementById("offenceFilter--bylawText"),y=!1,v="",n;n=function(){for(var a=document.createElement("tbody"),c=0,d=E.checked?parseInt(E.value):w.size,e=$jscomp.makeIterator(w.values()),f=e.next();!f.done;f=e.next())if(f=f.value,!(t&&u!==f.locationKey||y&&v!==f.bylawNumber)){var g=
m.get(f.locationKey);if(g){var h=r.get(f.bylawNumber);if(h){c+=1;if(c>d)break;var l=document.createElement("tr");l.innerHTML='<td class="has-border-right-width-2">'+cityssm.escapeHTML(g.locationName)+'<br /><span class="is-size-7">'+(k.has(g.locationClassKey)?k.get(g.locationClassKey).locationClass:g.locationClassKey)+"</span></td>"+('<td class="has-border-right-width-2"><strong>'+cityssm.escapeHTML(h.bylawNumber)+'</strong><br /><span class="is-size-7">'+cityssm.escapeHTML(h.bylawDescription)+"</span></td>")+
('<td class="has-text-right">$'+f.offenceAmount.toFixed(2)+'<br /><span class="is-size-7">'+f.accountNumber+"</span></td>")+('<td class="has-border-right-width-2"><div class="is-size-7">'+cityssm.escapeHTML(f.parkingOffence)+"</div></td>")+('<td class="has-text-right"><button class="button is-small" data-bylaw-number="'+f.bylawNumber+'" data-location-key="'+f.locationKey+'" type="button"><span class="icon is-small"><i class="fas fa-pencil-alt" aria-hidden="true"></i></span><span>Edit</span></button></td>');
l.getElementsByTagName("button")[0].addEventListener("click",b);a.appendChild(l)}}}cityssm.clearElement(z);0===c?z.innerHTML='<div class="message is-info"><div class="message-body"><p>There are no offences that match the given criteria.</p></div></div>':(z.innerHTML='<table class="table is-striped is-hoverable is-fullwidth"><thead><tr><th class="has-border-right-width-2">Location</th><th class="has-border-right-width-2">By-Law</th><th class="has-border-right-width-2" colspan="2">Offence</th><th class="has-width-50"></th></tr></thead></table>',
z.getElementsByTagName("table")[0].appendChild(a),c>d&&z.insertAdjacentHTML("afterbegin",'<div class="message is-warning"><div class="message-body has-text-centered">Limit Reached</div></div>'))};document.getElementById("is-add-offence-button").addEventListener("click",function(a){a.preventDefault();if(t&&y){a=r.get(v);var b=m.get(u);pts.confirmModal("Create Offence?",'<p class="has-text-centered">Are you sure you want to create the offence record below?</p><div class="columns has-margin-top-20 has-margin-bottom-20">'+
('<div class="column has-text-centered">'+cityssm.escapeHTML(b.locationName)+'<br /><span class="is-size-7">'+(k.has(b.locationClassKey)?k.get(b.locationClassKey).locationClass:b.locationClassKey)+"</span></div>")+('<div class="column has-text-centered">'+cityssm.escapeHTML(a.bylawNumber)+'<br /><span class="is-size-7">'+cityssm.escapeHTML(a.bylawDescription)+"</span></div>")+"</div>","Yes, Create Offence","info",function(){d(v,u,!0,function(a){a.success?a.message&&pts.alertModal("Offence Added Successfully",
a.message,"OK","warning"):pts.alertModal("Offence Not Added",a.message,"OK","danger")})})}else t||y?h():pts.alertModal("How to Add an Offence","To add an offence, use the main filters to select either a location, a by-law, or both.","OK","info")});C.addEventListener("dblclick",B);document.getElementById("is-select-location-filter-button").addEventListener("click",B);document.getElementById("is-clear-location-filter-button").addEventListener("click",function(){l();n()});t||l();D.addEventListener("dblclick",
p);document.getElementById("is-select-bylaw-filter-button").addEventListener("click",p);document.getElementById("is-clear-bylaw-filter-button").addEventListener("click",function(){c();n()});y||c();E.addEventListener("change",n);for(var x=0;x<pts.locationsInit.length;x+=1){var A=pts.locationsInit[x];m.set(A.locationKey,A)}delete pts.locationsInit;for(x=0;x<pts.bylawsInit.length;x+=1)A=pts.bylawsInit[x],r.set(A.bylawNumber,A);delete pts.bylawsInit;e(pts.offencesInit);delete pts.offencesInit;pts.getDefaultConfigProperty("locationClasses",
function(a){for(var b=0;b<a.length;b+=1){var c=a[b];k.set(c.locationClassKey,c)}n()})})();
