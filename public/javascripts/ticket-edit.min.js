(function(){document.getElementById("ticket--ticketID");pts.getDefaultConfigProperty("locationClasses",function(a){for(var b,k={},e={},c=0;c<a.length;c+=1){var d=a[c];k[d.locationClassKey]=d}var g=function(a){a.preventDefault();a=e[parseInt(a.currentTarget.getAttribute("data-index"))];document.getElementById("ticket--locationKey").value=a.locationKey;document.getElementById("ticket--locationName").value=a.locationName;b();e=[]},h=function(){pts.postJSON("/offences/doGetAllLocations",{},function(a){e=
a;a=document.createElement("div");a.className="list is-hoverable";for(var b=0;b<e.length;b+=1){var c=e[b],d=k[c.locationClassKey],f=document.createElement("a");f.className="list-item";f.setAttribute("data-index",b);f.setAttribute("href","#");f.addEventListener("click",g);f.innerHTML='<div class="level"><div class="level-left">'+pts.escapeHTML(c.locationName)+"</div>"+(d?'<div class="level-right"><span class="tag is-primary">'+pts.escapeHTML(d.locationClass)+"</span></div>":"")+"</div>";a.insertAdjacentElement("beforeend",
f)}b=document.getElementById("container--parkingLocations");pts.clearElement(b);b.insertAdjacentElement("beforeend",a)})};a=function(a){a.preventDefault();pts.openHtmlModal("ticket-setLocation",{onshown:function(a,c){b=c;h()},onremoved:function(){document.getElementById("is-location-lookup-button").focus()}})};document.getElementById("is-location-lookup-button").addEventListener("click",a);document.getElementById("ticket--locationName").addEventListener("dblclick",a)});var l,d=[],n=function(a){a.preventDefault();
a=d[parseInt(a.currentTarget.getAttribute("data-index"))];document.getElementById("ticket--bylawNumber").value=a.bylawNumber;var b=document.getElementById("ticket--offenceAmount");b.classList.add("is-readonly");b.setAttribute("readonly","readonly");b.closest(".field").getElementsByClassName("is-unlock-field-button")[0].removeAttribute("disabled");b.value=a.offenceAmount;document.getElementById("ticket--parkingOffence").value=a.bylawDescription;l();d=[]},p=function(){var a=document.getElementById("ticket--locationKey").value;
document.getElementById("ticket--locationName");pts.postJSON("/offences/doGetOffencesByLocation",{locationKey:a},function(a){d=a;a=document.createElement("div");a.className="list is-hoverable has-margin-bottom-20";for(var b=0;b<d.length;b+=1){var e=d[b],c=document.createElement("a");c.className="list-item";c.setAttribute("data-index",b);c.setAttribute("href","#");c.addEventListener("click",n);c.innerHTML='<div class="columns">'+('<div class="column">'+pts.escapeHTML(e.bylawNumber)+"<br /><small>"+
pts.escapeHTML(e.bylawDescription)+"</small></div>")+('<div class="column is-narrow">$ '+e.offenceAmount.toFixed(2)+"</div>")+"</div>";a.insertAdjacentElement("beforeend",c)}b=document.getElementById("container--bylawNumbers");pts.clearElement(b);b.appendChild(a)})},g=function(a){a.preventDefault();pts.openHtmlModal("ticket-setBylawOffence",{onshown:function(a,d){l=d;p();document.getElementById("bylawLookup--searchStr").focus()},onremoved:function(){document.getElementById("is-bylaw-lookup-button").focus()}})};
document.getElementById("is-bylaw-lookup-button").addEventListener("click",g);document.getElementById("ticket--bylawNumber").addEventListener("dblclick",g);for(var g=function(a){a.preventDefault();a=a.currentTarget;var b=a.getAttribute("data-unlock"),b=a.closest(".field").getElementsByTagName(b)[0];b.removeAttribute("readonly");b.classList.remove("is-readonly");b.focus();a.setAttribute("disabled","disabled")},m=document.getElementsByClassName("is-unlock-field-button"),h=0;h<m.length;h+=1)m[h].addEventListener("click",
g)})();
