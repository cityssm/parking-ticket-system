var $jscomp={scope:{}};$jscomp.defineProperty="function"==typeof Object.defineProperties?Object.defineProperty:function(b,f,d){if(d.get||d.set)throw new TypeError("ES3 does not support getters and setters.");b!=Array.prototype&&b!=Object.prototype&&(b[f]=d.value)};$jscomp.getGlobal=function(b){return"undefined"!=typeof window&&window===b?b:"undefined"!=typeof global&&null!=global?global:b};$jscomp.global=$jscomp.getGlobal(this);$jscomp.SYMBOL_PREFIX="jscomp_symbol_";
$jscomp.initSymbol=function(){$jscomp.initSymbol=function(){};$jscomp.global.Symbol||($jscomp.global.Symbol=$jscomp.Symbol)};$jscomp.symbolCounter_=0;$jscomp.Symbol=function(b){return $jscomp.SYMBOL_PREFIX+(b||"")+$jscomp.symbolCounter_++};
$jscomp.initSymbolIterator=function(){$jscomp.initSymbol();var b=$jscomp.global.Symbol.iterator;b||(b=$jscomp.global.Symbol.iterator=$jscomp.global.Symbol("iterator"));"function"!=typeof Array.prototype[b]&&$jscomp.defineProperty(Array.prototype,b,{configurable:!0,writable:!0,value:function(){return $jscomp.arrayIterator(this)}});$jscomp.initSymbolIterator=function(){}};$jscomp.arrayIterator=function(b){var f=0;return $jscomp.iteratorPrototype(function(){return f<b.length?{done:!1,value:b[f++]}:{done:!0}})};
$jscomp.iteratorPrototype=function(b){$jscomp.initSymbolIterator();b={next:b};b[$jscomp.global.Symbol.iterator]=function(){return this};return b};$jscomp.array=$jscomp.array||{};$jscomp.iteratorFromArray=function(b,f){$jscomp.initSymbolIterator();b instanceof String&&(b+="");var d=0,h={next:function(){if(d<b.length){var g=d++;return{value:f(g,b[g]),done:!1}}h.next=function(){return{done:!0,value:void 0}};return h.next()}};h[Symbol.iterator]=function(){return h};return h};
$jscomp.polyfill=function(b,f,d,h){if(f){d=$jscomp.global;b=b.split(".");for(h=0;h<b.length-1;h++){var g=b[h];g in d||(d[g]={});d=d[g]}b=b[b.length-1];h=d[b];f=f(h);f!=h&&null!=f&&$jscomp.defineProperty(d,b,{configurable:!0,writable:!0,value:f})}};$jscomp.polyfill("Array.prototype.values",function(b){return b?b:function(){return $jscomp.iteratorFromArray(this,function(b,d){return d})}},"es6","es3");
(function(){for(var b=document.getElementById("ticket--ticketID").value,f=""===b,d=document.getElementById("container--form-message"),h=function(a){pts.enableNavBlocker();d.innerHTML='<span class="tag is-light is-info is-medium"><span class="icon"><i class="fas fa-exclamation-triangle" aria-hidden="true"></i></span> <span>Unsaved Changes</span></div>'},g=document.querySelectorAll(".input, .select, .textarea"),n=0;n<g.length;n+=1)g[n].addEventListener("change",h);document.getElementById("form--ticket").addEventListener("submit",
function(a){a.preventDefault();var c=document.getElementById("ticket--ticketNumber").value;d.innerHTML='<span class="tag is-light is-info is-medium"><span>Saving ticket... </span> <span class="icon"><i class="fas fa-circle-notch fa-spin" aria-hidden="true"></i></span></div>';pts.postJSON(f?"/tickets/doCreateTicket":"/tickets/doUpdateTicket",a.currentTarget,function(a){a.success?(pts.disableNavBlocker(),d.innerHTML='<span class="tag is-light is-success is-medium"><span class="icon"><i class="fas fa-check" aria-hidden="true"></i></span> <span>Saved Successfully</span></div>'):
(h(),pts.alertModal("Ticket Not Saved",a.message,"OK","danger"));a.success&&f&&pts.openHtmlModal("ticket-createSuccess",{onshow:function(){document.getElementById("createSuccess--ticketNumber").innerText=c;document.getElementById("createSuccess--editTicketButton").setAttribute("href","/tickets/"+a.ticketID+"/edit");document.getElementById("createSuccess--newTicketButton").setAttribute("href","/tickets/new/"+a.nextTicketNumber)}})})});pts.getDefaultConfigProperty("locationClasses",function(a){for(var c,
b={},e={},k=0;k<a.length;k+=1){var l=a[k];b[l.locationClassKey]=l}var d=function(a){a.preventDefault();a=e[parseInt(a.currentTarget.getAttribute("data-index"))];document.getElementById("ticket--locationKey").value=a.locationKey;document.getElementById("ticket--locationName").value=a.locationName;c();e=[]},f=function(){pts.postJSON("/offences/doGetAllLocations",{},function(a){e=a;a=document.createElement("div");a.className="list is-hoverable";for(var c=0;c<e.length;c+=1){var m=e[c],k=b[m.locationClassKey],
l=document.createElement("a");l.className="list-item";l.setAttribute("data-index",c);l.setAttribute("href","#");l.addEventListener("click",d);l.innerHTML='<div class="level"><div class="level-left">'+pts.escapeHTML(m.locationName)+"</div>"+(k?'<div class="level-right"><span class="tag is-primary">'+pts.escapeHTML(k.locationClass)+"</span></div>":"")+"</div>";a.insertAdjacentElement("beforeend",l)}c=document.getElementById("container--parkingLocations");pts.clearElement(c);c.insertAdjacentElement("beforeend",
a)})};a=function(a){a.preventDefault();pts.openHtmlModal("ticket-setLocation",{onshown:function(a,b){c=b;f()},onremoved:function(){document.getElementById("is-location-lookup-button").focus()}})};document.getElementById("is-location-lookup-button").addEventListener("click",a);document.getElementById("ticket--locationName").addEventListener("dblclick",a)});var y,q=[],C=function(a){a.preventDefault();a=q[parseInt(a.currentTarget.getAttribute("data-index"))];document.getElementById("ticket--bylawNumber").value=
a.bylawNumber;var c=document.getElementById("ticket--offenceAmount");c.classList.add("is-readonly");c.setAttribute("readonly","readonly");c.closest(".field").getElementsByClassName("is-unlock-field-button")[0].removeAttribute("disabled");c.value=a.offenceAmount;document.getElementById("ticket--parkingOffence").value=a.bylawDescription;y();q=[]},D=function(){var a=document.getElementById("ticket--locationKey").value;document.getElementById("ticket--locationName");pts.postJSON("/offences/doGetOffencesByLocation",
{locationKey:a},function(a){q=a;a=document.createElement("div");a.className="list is-hoverable has-margin-bottom-20";for(var c=0;c<q.length;c+=1){var b=q[c],k=document.createElement("a");k.className="list-item";k.setAttribute("data-index",c);k.setAttribute("href","#");k.addEventListener("click",C);k.innerHTML='<div class="columns">'+('<div class="column">'+pts.escapeHTML(b.bylawNumber)+"<br /><small>"+pts.escapeHTML(b.bylawDescription)+"</small></div>")+('<div class="column is-narrow">$ '+b.offenceAmount.toFixed(2)+
"</div>")+"</div>";a.insertAdjacentElement("beforeend",k)}c=document.getElementById("container--bylawNumbers");pts.clearElement(c);c.appendChild(a)})},g=function(a){a.preventDefault();pts.openHtmlModal("ticket-setBylawOffence",{onshown:function(a,b){y=b;D();document.getElementById("bylawLookup--searchStr").focus()},onremoved:function(){document.getElementById("is-bylaw-lookup-button").focus()}})};document.getElementById("is-bylaw-lookup-button").addEventListener("click",g);document.getElementById("ticket--bylawNumber").addEventListener("dblclick",
g);g=function(){var a=document.getElementById("datalist--licencePlateProvince");pts.clearElement(a);var c=pts.getLicencePlateCountryProperties(document.getElementById("ticket--licencePlateCountry").value);if(c&&c.provinces)for(var c=Object.values(c.provinces),b=0;b<c.length;b+=1){var e=document.createElement("option");e.setAttribute("value",c[b].provinceShortName);a.appendChild(e)}};document.getElementById("ticket--licencePlateCountry").addEventListener("change",g);pts.loadDefaultConfigProperties(g);
var u=function(a){for(a=a.getElementsByClassName("panel-block");0<a.length;)a[0].remove()};if(!f){var r=document.getElementById("is-remark-panel"),t=pts.ticketRemarksInit;delete pts.ticketRemarksInit;var v,E=function(a){var c=a.currentTarget.getAttribute("data-remark-index");pts.confirmModal("Delete Remark?","Are you sure you want to delete this remark?","Yes, Delete","warning",function(){pts.postJSON("/tickets/doDeleteRemark",{ticketID:b,remarkIndex:c},function(a){a.success&&v()})})},F=function(a){a.preventDefault();
var c;a=parseInt(a.currentTarget.getAttribute("data-index"));var m=t[a],e=function(a){a.preventDefault();pts.postJSON("/tickets/doUpdateRemark",a.currentTarget,function(a){a.success&&(c(),v())})};pts.openHtmlModal("ticket-editRemark",{onshow:function(a){document.getElementById("editRemark--ticketID").value=b;document.getElementById("editRemark--remarkIndex").value=m.remarkIndex;document.getElementById("editRemark--remark").value=m.remark;document.getElementById("editRemark--remarkDateString").value=
m.remarkDateString;document.getElementById("editRemark--remarkTimeString").value=m.remarkTimeString;a.getElementsByTagName("form")[0].addEventListener("submit",e)},onshown:function(a,b){c=b}})},z=function(){u(r);if(0===t.length)r.insertAdjacentHTML("beforeend",'<div class="panel-block is-block"><div class="message is-info"><p class="message-body">There are no remarks associated with this ticket.</p></div></div>');else for(var a=0;a<t.length;a+=1){var c=t[a],b=document.createElement("div");b.className=
"panel-block is-block";b.innerHTML='<div class="columns">'+('<div class="column"><p class="has-newline-chars">'+pts.escapeHTML(c.remark)+'</p><p class="is-size-7">'+(c.recordCreate_timeMillis===c.recordUpdate_timeMillis?"":'<i class="fas fa-pencil-alt" aria-hidden="true"></i> ')+c.recordUpdate_userName+" - "+c.remarkDateString+" "+c.remarkTimeString+"</p></div>")+(c.canUpdate?'<div class="column is-narrow"><div class="buttons is-right has-addons"><button class="button is-small is-edit-remark-button" data-tooltip="Edit Remark" data-index="'+
a+'" type="button"><span class="icon is-small"><i class="fas fa-pencil-alt" aria-hidden="true"></i></span> <span>Edit</span></button><button class="button is-small has-text-danger is-delete-remark-button" data-tooltip="Delete Remark" data-remark-index="'+c.remarkIndex+'" type="button"><i class="fas fa-trash" aria-hidden="true"></i><span class="sr-only">Delete</span></button></div></div>':"")+"</div>";c.canUpdate&&(b.getElementsByClassName("is-edit-remark-button")[0].addEventListener("click",F),b.getElementsByClassName("is-delete-remark-button")[0].addEventListener("click",
E));r.appendChild(b)}};v=function(){u(r);r.insertAdjacentHTML("beforeend",'<div class="panel-block is-block"><p class="has-text-centered has-text-grey-lighter"><i class="fas fa-2x fa-circle-notch fa-spin" aria-hidden="true"></i><br /><em>Loading remarks...</p></div>');pts.postJSON("/tickets/doGetRemarks",{ticketID:b},function(a){t=a;z()})};document.getElementById("is-add-remark-button").addEventListener("click",function(a){a.preventDefault();var c,d=function(a){a.preventDefault();pts.postJSON("/tickets/doAddRemark",
a.currentTarget,function(a){a.success&&(c(),v())})};pts.openHtmlModal("ticket-addRemark",{onshow:function(a){document.getElementById("addRemark--ticketID").value=b;a.getElementsByTagName("form")[0].addEventListener("submit",d)},onshown:function(a,b){c=b}})});z()}if(!f){var p=document.getElementById("is-status-panel"),w=pts.ticketStatusLogInit;delete pts.ticketStatusLogInit;var A,G=function(a){},H=function(a){},B=function(){u(p);if(0===w.length)p.insertAdjacentHTML("beforeend",'<div class="panel-block is-block"><div class="message is-info"><p class="message-body">There are no statuses associated with this ticket.</p></div></div>');
else for(var a=0;a<w.length;a+=1){var b=w[a],d=pts.getTicketStatus(b.statusKey);if(0===a&&d&&d.isFinalStatus){var e=document.createElement("div");e.className="panel-block is-block";e.innerHTML='<div class="message is-info is-clearfix"><div class="message-body"><div class="columns"><div class="column"><strong>This ticket is able to be marked as resolved.</strong></div><div class="column is-narrow"><button class="button is-info" type="button"><span class="icon is-small"><i class="fas fa-check" aria-hidden="true"></i></span><span>Resolve Ticket</span></button></div></div></div></div>';
p.appendChild(e)}e=document.createElement("div");e.className="panel-block is-block";e.innerHTML='<div class="columns">'+('<div class="column">'+('<div class="level has-margin-bottom-5"><div class="level-left"><strong>'+(d?d.status:b.statusKey)+'</strong></div><div class="level-right">'+b.statusDateString+"</div></div>")+(""===b.statusField?"":'<p class="is-size-7"><strong>'+(d&&d.statusField?d.statusField.fieldLabel:"")+":</strong> "+b.statusField+"</p>")+'<p class="is-size-7">'+b.statusNote+"</p></div>")+
(b.canUpdate&&0===a?'<div class="column is-narrow"><div class="buttons is-right has-addons"><button class="button is-small is-edit-status-button" data-tooltip="Edit Status" data-index="'+a+'" type="button"><span class="icon is-small"><i class="fas fa-pencil-alt" aria-hidden="true"></i></span> <span>Edit</span></button><button class="button is-small has-text-danger is-delete-status-button" data-tooltip="Delete Status" data-status-index="'+b.statusIndex+'" type="button"><i class="fas fa-trash" aria-hidden="true"></i><span class="sr-only">Delete</span></button></div></div>':
"")+"</div>";b.canUpdate&&0===a&&(e.getElementsByClassName("is-edit-status-button")[0].addEventListener("click",H),e.getElementsByClassName("is-delete-status-button")[0].addEventListener("click",G));p.appendChild(e)}};A=function(){u(p);p.insertAdjacentHTML("beforeend",'<div class="panel-block is-block"><p class="has-text-centered has-text-grey-lighter"><i class="fas fa-2x fa-circle-notch fa-spin" aria-hidden="true"></i><br /><em>Loading statuses...</p></div>');pts.postJSON("/tickets/doGetStatuses",
{ticketID:b},function(a){w=a;B()})};document.getElementById("is-add-status-button").addEventListener("click",function(a){a.preventDefault();var c,d=function(a){a.preventDefault();pts.postJSON("/tickets/doAddStatus",a.currentTarget,function(a){a.success&&(c(),A())})},e=function(a){a=pts.getTicketStatus(a.currentTarget.value);var b=document.getElementById("addStatus--statusField");b.value="";a&&a.statusField?(b=b.closest(".field"),b.getElementsByTagName("label")[0].innerText=a.statusField.fieldLabel,
b.classList.remove("is-hidden")):b.closest(".field").classList.add("is-hidden");b=document.getElementById("addStatus--resolveTicket");b.checked=!1;a&&a.isFinalStatus?b.closest(".field").classList.remove("is-hidden"):b.closest(".field").classList.add("is-hidden")};pts.openHtmlModal("ticket-addStatus",{onshow:function(a){document.getElementById("addStatus--ticketID").value=b;pts.getDefaultConfigProperty("parkingTicketStatuses",function(a){for(var b=document.getElementById("addStatus--statusKey"),c=
0;c<a.length;c+=1){var d=a[c];d.isUserSettable&&b.insertAdjacentHTML("beforeend",'<option value="'+d.statusKey+'">'+d.status+"</option>")}b.addEventListener("change",e)});a.getElementsByTagName("form")[0].addEventListener("submit",d)},onshown:function(a,b){c=b}})});pts.loadDefaultConfigProperties(B)}for(var g=function(a){a.preventDefault();a=a.currentTarget;var b=a.getAttribute("data-unlock"),b=a.closest(".field").getElementsByTagName(b)[0];b.removeAttribute("readonly");b.classList.remove("is-readonly");
b.focus();a.setAttribute("disabled","disabled")},n=document.getElementsByClassName("is-unlock-field-button"),x=0;x<n.length;x+=1)n[x].addEventListener("click",g)})();
