"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),function(){var e="",t=document.getElementById("locationFilter--locationClassKey"),o=document.getElementById("locationFilter--locationName"),n=document.getElementById("locationResults"),a=new Map,i=exports.locations;function s(t){t.preventDefault();var o,n=parseInt(t.currentTarget.getAttribute("data-index"),10),s=i[n],c=function(){cityssm.postJSON("/admin/doDeleteLocation",{locationKey:s.locationKey},function(e){e.success&&(o(),i=e.locations,l())})},d=function(e){e.preventDefault(),cityssm.confirmModal("Delete Location",'Are you sure you want to remove "'+s.locationName+'" from the list of available options?',"Yes, Remove Location","danger",c)},r=function(e){e.preventDefault(),cityssm.postJSON("/admin/doUpdateLocation",e.currentTarget,function(e){e.success&&(o(),i=e.locations,l())})};cityssm.openHtmlModal("location-edit",{onshow:function(){document.getElementById("editLocation--locationKey").value=s.locationKey;var t=document.getElementById("editLocation--locationClassKey");t.innerHTML=e,a.has(s.locationClassKey)||t.insertAdjacentHTML("beforeend",'<option value="'+cityssm.escapeHTML(s.locationClassKey)+'">'+cityssm.escapeHTML(s.locationClassKey)+"</option>"),t.value=s.locationClassKey,document.getElementById("editLocation--locationName").value=s.locationName},onshown:function(e,t){o=t,document.getElementById("form--editLocation").addEventListener("submit",r),e.getElementsByClassName("is-delete-button")[0].addEventListener("click",d)}})}function l(){for(var e=0,l=t.value,c=o.value.trim().toLowerCase().split(" "),d=document.createElement("tbody"),r=0;r<i.length;r+=1){var m=i[r];if(""===l||l===m.locationClassKey){for(var u=!0,y=m.locationName.toLowerCase(),f=0;f<c.length;f+=1)if(-1===y.indexOf(c[f])){u=!1;break}if(u){e+=1;var v=a.has(m.locationClassKey)?a.get(m.locationClassKey).locationClass:m.locationClassKey,p=document.createElement("tr");p.innerHTML='<td><a data-index="'+r+'" href="#">'+cityssm.escapeHTML(m.locationName)+"</a></td><td>"+cityssm.escapeHTML(v)+"</td>",p.getElementsByTagName("a")[0].addEventListener("click",s),d.appendChild(p)}}}cityssm.clearElement(n),0!==e?(n.innerHTML='<table class="table is-fixed is-striped is-hoverable is-fullwidth"><thead><tr><th>Location</th><th>Class</th></tr></thead></table>',n.getElementsByTagName("table")[0].appendChild(d)):n.innerHTML='<div class="message is-info"><div class="message-body">There are no locations that meet your search criteria.</div></div>'}delete exports.locations,t.addEventListener("change",l),o.addEventListener("keyup",l),pts.getDefaultConfigProperty("locationClasses",function(o){t.innerHTML='<option value="">(All Location Classes)</option>';for(var n=0;n<o.length;n+=1){var i=o[n];e+='<option value="'+i.locationClassKey+'">'+cityssm.escapeHTML(i.locationClass)+"</option>",a.set(i.locationClassKey,i)}t.insertAdjacentHTML("beforeend",e),l()}),document.getElementById("is-add-location-button").addEventListener("click",function(t){var o;t.preventDefault();var n=function(e){e.preventDefault(),cityssm.postJSON("/admin/doAddLocation",e.currentTarget,function(e){e.success?(o(),i=e.locations,l()):cityssm.alertModal("Location Not Added",e.message,"OK","danger")})};cityssm.openHtmlModal("location-add",{onshown:function(t,a){o=a,document.getElementById("addLocation--locationClassKey").insertAdjacentHTML("beforeend",e),document.getElementById("form--addLocation").addEventListener("submit",n)}})})}();