var $jscomp={scope:{}};$jscomp.defineProperty="function"==typeof Object.defineProperties?Object.defineProperty:function(a,e,b){if(b.get||b.set)throw new TypeError("ES3 does not support getters and setters.");a!=Array.prototype&&a!=Object.prototype&&(a[e]=b.value)};$jscomp.getGlobal=function(a){return"undefined"!=typeof window&&window===a?a:"undefined"!=typeof global&&null!=global?global:a};$jscomp.global=$jscomp.getGlobal(this);$jscomp.SYMBOL_PREFIX="jscomp_symbol_";
$jscomp.initSymbol=function(){$jscomp.initSymbol=function(){};$jscomp.global.Symbol||($jscomp.global.Symbol=$jscomp.Symbol)};$jscomp.symbolCounter_=0;$jscomp.Symbol=function(a){return $jscomp.SYMBOL_PREFIX+(a||"")+$jscomp.symbolCounter_++};
$jscomp.initSymbolIterator=function(){$jscomp.initSymbol();var a=$jscomp.global.Symbol.iterator;a||(a=$jscomp.global.Symbol.iterator=$jscomp.global.Symbol("iterator"));"function"!=typeof Array.prototype[a]&&$jscomp.defineProperty(Array.prototype,a,{configurable:!0,writable:!0,value:function(){return $jscomp.arrayIterator(this)}});$jscomp.initSymbolIterator=function(){}};$jscomp.arrayIterator=function(a){var e=0;return $jscomp.iteratorPrototype(function(){return e<a.length?{done:!1,value:a[e++]}:{done:!0}})};
$jscomp.iteratorPrototype=function(a){$jscomp.initSymbolIterator();a={next:a};a[$jscomp.global.Symbol.iterator]=function(){return this};return a};$jscomp.makeIterator=function(a){$jscomp.initSymbolIterator();var e=a[Symbol.iterator];return e?e.call(a):$jscomp.arrayIterator(a)};$jscomp.owns=function(a,e){return Object.prototype.hasOwnProperty.call(a,e)};
$jscomp.polyfill=function(a,e,b,d){if(e){b=$jscomp.global;a=a.split(".");for(d=0;d<a.length-1;d++){var k=a[d];k in b||(b[k]={});b=b[k]}a=a[a.length-1];d=b[a];e=e(d);e!=d&&null!=e&&$jscomp.defineProperty(b,a,{configurable:!0,writable:!0,value:e})}};
$jscomp.polyfill("WeakMap",function(a){function e(a){$jscomp.owns(a,d)||$jscomp.defineProperty(a,d,{value:{}})}function b(a){var c=Object[a];c&&(Object[a]=function(a){e(a);return c(a)})}if(function(){if(!a||!Object.seal)return!1;try{var b=Object.seal({}),c=Object.seal({}),g=new a([[b,2],[c,3]]);if(2!=g.get(b)||3!=g.get(c))return!1;g["delete"](b);g.set(c,4);return!g.has(b)&&4==g.get(c)}catch(w){return!1}}())return a;var d="$jscomp_hidden_"+Math.random().toString().substring(2);b("freeze");b("preventExtensions");
b("seal");var k=0,l=function(a){this.id_=(k+=Math.random()+1).toString();if(a){$jscomp.initSymbol();$jscomp.initSymbolIterator();a=$jscomp.makeIterator(a);for(var c;!(c=a.next()).done;)c=c.value,this.set(c[0],c[1])}};l.prototype.set=function(a,c){e(a);if(!$jscomp.owns(a,d))throw Error("WeakMap key fail: "+a);a[d][this.id_]=c;return this};l.prototype.get=function(a){return $jscomp.owns(a,d)?a[d][this.id_]:void 0};l.prototype.has=function(a){return $jscomp.owns(a,d)&&$jscomp.owns(a[d],this.id_)};l.prototype["delete"]=
function(a){return $jscomp.owns(a,d)&&$jscomp.owns(a[d],this.id_)?delete a[d][this.id_]:!1};return l},"es6-impl","es3");$jscomp.ASSUME_NO_NATIVE_MAP=!1;
$jscomp.polyfill("Map",function(a){if(!$jscomp.ASSUME_NO_NATIVE_MAP&&function(){if(!a||!a.prototype.entries||"function"!=typeof Object.seal)return!1;try{var c=Object.seal({x:4}),g=new a($jscomp.makeIterator([[c,"s"]]));if("s"!=g.get(c)||1!=g.size||g.get({x:4})||g.set({x:4},"t")!=g||2!=g.size)return!1;var w=g.entries(),b=w.next();if(b.done||b.value[0]!=c||"s"!=b.value[1])return!1;b=w.next();return b.done||4!=b.value[0].x||"t"!=b.value[1]||!w.next().done?!1:!0}catch(C){return!1}}())return a;$jscomp.initSymbol();
$jscomp.initSymbolIterator();var e=new WeakMap,b=function(a){this.data_={};this.head_=l();this.size=0;if(a){a=$jscomp.makeIterator(a);for(var c;!(c=a.next()).done;)c=c.value,this.set(c[0],c[1])}};b.prototype.set=function(a,b){var c=d(this,a);c.list||(c.list=this.data_[c.id]=[]);c.entry?c.entry.value=b:(c.entry={next:this.head_,previous:this.head_.previous,head:this.head_,key:a,value:b},c.list.push(c.entry),this.head_.previous.next=c.entry,this.head_.previous=c.entry,this.size++);return this};b.prototype["delete"]=
function(a){a=d(this,a);return a.entry&&a.list?(a.list.splice(a.index,1),a.list.length||delete this.data_[a.id],a.entry.previous.next=a.entry.next,a.entry.next.previous=a.entry.previous,a.entry.head=null,this.size--,!0):!1};b.prototype.clear=function(){this.data_={};this.head_=this.head_.previous=l();this.size=0};b.prototype.has=function(a){return!!d(this,a).entry};b.prototype.get=function(a){return(a=d(this,a).entry)&&a.value};b.prototype.entries=function(){return k(this,function(a){return[a.key,
a.value]})};b.prototype.keys=function(){return k(this,function(a){return a.key})};b.prototype.values=function(){return k(this,function(a){return a.value})};b.prototype.forEach=function(a,b){for(var c=this.entries(),g;!(g=c.next()).done;)g=g.value,a.call(b,g[1],g[0],this)};b.prototype[Symbol.iterator]=b.prototype.entries;var d=function(a,b){var c;c=b&&typeof b;"object"==c||"function"==c?e.has(b)?c=e.get(b):(c=""+ ++B,e.set(b,c)):c="p_"+b;var d=a.data_[c];if(d&&$jscomp.owns(a.data_,c))for(var g=0;g<
d.length;g++){var k=d[g];if(b!==b&&k.key!==k.key||b===k.key)return{id:c,list:d,index:g,entry:k}}return{id:c,list:d,index:-1,entry:void 0}},k=function(a,b){var c=a.head_;return $jscomp.iteratorPrototype(function(){if(c){for(;c.head!=a.head_;)c=c.previous;for(;c.next!=c.head;)return c=c.next,{done:!1,value:b(c)};c=null}return{done:!0,value:void 0}})},l=function(){var a={};return a.previous=a.next=a.head=a},B=0;return b},"es6-impl","es3");$jscomp.array=$jscomp.array||{};
$jscomp.iteratorFromArray=function(a,e){$jscomp.initSymbolIterator();a instanceof String&&(a+="");var b=0,d={next:function(){if(b<a.length){var k=b++;return{value:e(k,a[k]),done:!1}}d.next=function(){return{done:!0,value:void 0}};return d.next()}};d[Symbol.iterator]=function(){return d};return d};$jscomp.polyfill("Array.prototype.values",function(a){return a?a:function(){return $jscomp.iteratorFromArray(this,function(a,b){return b})}},"es6","es3");
(function(){function a(a,c){return a+"::::"+c}function e(c){g.clear();for(var b=0;b<c.length;b+=1){var p=c[b],d=a(p.bylawNumber,p.locationKey);g.set(d,p)}}function b(b){b.preventDefault();b=b.currentTarget;b=a(b.getAttribute("data-bylaw-number"),b.getAttribute("data-location-key"));var d=g.get(b),p=n.get(d.locationKey),z=q.get(d.bylawNumber),f,h=function(){pts.postJSON("/admin/doDeleteOffence",{bylawNumber:d.bylawNumber,locationKey:d.locationKey},function(a){a.success&&(e(a.offences),f(),m())})},
I=function(a){a.preventDefault();pts.confirmModal("Remove Offence?","Are you sure you want to remove this offence?","Yes, Remove Offence","warning",h)},H=function(a){a.preventDefault();pts.postJSON("/admin/doUpdateOffence",a.currentTarget,function(a){a.success&&(e(a.offences),f(),m())})};pts.openHtmlModal("offence-edit",{onshow:function(){document.getElementById("offenceEdit--locationKey").value=d.locationKey;document.getElementById("offenceEdit--bylawNumber").value=d.bylawNumber;document.getElementById("offenceEdit--locationName").innerText=
p.locationName;document.getElementById("offenceEdit--locationClass").innerText=c.has(p.locationClassKey)?c.get(p.locationClassKey).locationClass:p.locationClassKey;document.getElementById("offenceEdit--bylawNumberSpan").innerText=z.bylawNumber;document.getElementById("offenceEdit--bylawDescription").innerText=z.bylawDescription;document.getElementById("offenceEdit--parkingOffence").value=d.parkingOffence;document.getElementById("offenceEdit--offenceAmount").value=d.offenceAmount;var a=document.getElementById("offenceEdit--accountNumber");
a.value=d.accountNumber;a.setAttribute("pattern",w)},onshown:function(a,c){f=c;a.getElementsByTagName("form")[0].addEventListener("submit",H);a.getElementsByClassName("is-delete-button")[0].addEventListener("click",I)}})}function d(a,c,b,d){pts.postJSON("/admin/doAddOffence",{bylawNumber:a,locationKey:c,returnOffences:b},function(a){a.success&&a.offences&&b&&(e(a.offences),m());d&&d(a)})}function k(){var b=!1,D=function(a){a.preventDefault();var c=a.currentTarget;a=c.getAttribute("data-bylaw-number");
var f=c.getAttribute("data-location-key");d(a,f,!1,function(a){a.success&&(c.remove(),b=!0)})};pts.openHtmlModal("offence-addFromList",{onshow:function(a){var b,f;if(r){b="Select By-Laws";f=n.get(t);var d=c.get(f.locationClassKey);f=pts.escapeHTML(f.locationName)+'<br /><span class="is-size-7">'+pts.escapeHTML(d?d.locationClass:f.locationClassKey)+"</span>"}else b="Select Locations",f=q.get(u),f=pts.escapeHTML(f.bylawNumber)+'<br /><span class="is-size-7">'+f.bylawDescription+"</span>";a.getElementsByClassName("modal-card-title")[0].innerHTML=
b;document.getElementById("addContainer--selected").innerHTML=f},onshown:function(){var b=document.createElement("div");b.className="list has-margin-bottom-20";var d=0;if(r)for(var f=$jscomp.makeIterator(q.values()),h=f.next();!h.done;h=f.next()){var h=h.value,e=a(h.bylawNumber,t);g.has(e)||(d+=1,e=document.createElement("a"),e.className="list-item",e.setAttribute("data-bylaw-number",h.bylawNumber),e.setAttribute("data-location-key",t),e.innerHTML=pts.escapeHTML(h.bylawNumber)+'<br /><span class="is-size-7">'+
pts.escapeHTML(h.bylawDescription)+"</span>",e.addEventListener("click",D),b.appendChild(e))}else for(f=$jscomp.makeIterator(n.values()),h=f.next();!h.done;h=f.next())h=h.value,e=a(u,h.locationKey),g.has(e)||(d+=1,e=document.createElement("a"),e.className="list-item",e.setAttribute("data-bylaw-number",u),e.setAttribute("data-location-key",h.locationKey),e.innerHTML=pts.escapeHTML(h.locationName)+'<br /><span class="is-size-7">'+(c.has(h.locationClassKey)?pts.escapeHTML(c.get(h.locationClassKey).locationClass):
h.locationClassKey)+"</span>",e.addEventListener("click",D),b.appendChild(e));f=document.getElementById("addContainer--results");pts.clearElement(f);0===d?f.innerHTML='<div class="message is-info"><div class="message-body">There are no offence records available for creation.</div></div>':f.appendChild(b)},onremoved:function(){b&&pts.postJSON("/offences/doGetAllOffences",{},function(a){e(a);m()})}})}function l(){E.value="";pts.clearElement(J);t="";r=!1}function B(){F.value="";pts.clearElement(G);u=
"";x=!1}var c=new Map,g=new Map,w=pts.accountNumberPatternInit;delete pts.accountNumberPatternInit;var n=new Map,C=document.getElementById("offenceFilter--limitResults"),y=document.getElementById("offenceResults"),E=document.getElementById("offenceFilter--location"),J=document.getElementById("offenceFilter--locationText"),r=!1,t="",q=new Map,F=document.getElementById("offenceFilter--bylaw"),G=document.getElementById("offenceFilter--bylawText"),x=!1,u="",m;m=function(){for(var a=document.createElement("tbody"),
d=0,e=C.checked?parseInt(C.value):g.size,z=$jscomp.makeIterator(g.values()),f=z.next();!f.done;f=z.next())if(f=f.value,!(r&&t!==f.locationKey||x&&u!==f.bylawNumber)){var h=n.get(f.locationKey);if(h){var k=q.get(f.bylawNumber);if(k){d+=1;if(d>e)break;var l=document.createElement("tr");l.innerHTML='<td class="has-border-right-width-2">'+pts.escapeHTML(h.locationName)+'<br /><span class="is-size-7">'+(c.has(h.locationClassKey)?c.get(h.locationClassKey).locationClass:h.locationClassKey)+"</span></td>"+
('<td class="has-border-right-width-2"><strong>'+pts.escapeHTML(k.bylawNumber)+'</strong><br /><span class="is-size-7">'+pts.escapeHTML(k.bylawDescription)+"</span></td>")+('<td class="has-text-right">$'+f.offenceAmount.toFixed(2)+'<br /><span class="is-size-7">'+f.accountNumber+"</span></td>")+('<td class="has-border-right-width-2"><div class="is-size-7">'+pts.escapeHTML(f.parkingOffence)+"</div></td>")+('<td class="has-text-right"><button class="button is-small" data-bylaw-number="'+f.bylawNumber+
'" data-location-key="'+f.locationKey+'" type="button"><span class="icon is-small"><i class="fas fa-pencil-alt" aria-hidden="true"></i></span><span>Edit</span></button></td>');l.getElementsByTagName("button")[0].addEventListener("click",b);a.appendChild(l)}}}pts.clearElement(y);0===d?y.innerHTML='<div class="message is-info"><div class="message-body"><p>There are no offences that match the given criteria.</p></div></div>':(y.innerHTML='<table class="table is-striped is-hoverable is-fullwidth"><thead><tr><th class="has-border-right-width-2">Location</th><th class="has-border-right-width-2">By-Law</th><th class="has-border-right-width-2" colspan="2">Offence</th><th class="has-width-50"></th></tr></thead></table>',
y.getElementsByTagName("table")[0].appendChild(a),d>e&&y.insertAdjacentHTML("afterbegin",'<div class="message is-warning"><div class="message-body has-text-centered">Limit Reached</div></div>'))};document.getElementById("is-add-offence-button").addEventListener("click",function(a){a.preventDefault();if(r&&x){a=q.get(u);var b=n.get(t);pts.confirmModal("Create Offence?",'<p class="has-text-centered">Are you sure you want to create the offence record below?</p><div class="columns has-margin-top-20 has-margin-bottom-20">'+
('<div class="column has-text-centered">'+pts.escapeHTML(b.locationName)+'<br /><span class="is-size-7">'+(c.has(b.locationClassKey)?c.get(b.locationClassKey).locationClass:b.locationClassKey)+"</span></div>")+('<div class="column has-text-centered">'+pts.escapeHTML(a.bylawNumber)+'<br /><span class="is-size-7">'+pts.escapeHTML(a.bylawDescription)+"</span></div>")+"</div>","Yes, Create Offence","info",function(){d(u,t,!0,function(a){a.success?a.message&&pts.alertModal("Offence Added Successfully",
a.message,"OK","warning"):pts.alertModal("Offence Not Added",a.message,"OK","danger")})})}else r||x?k():pts.alertModal("How to Add an Offence","To add an offence, use the main filters to select either a location, a by-law, or both.","OK","info")});document.getElementById("is-select-location-filter-button").addEventListener("click",function(){var a,b=function(b){b.preventDefault();b=n.get(b.currentTarget.getAttribute("data-location-key"));r=!0;t=b.locationKey;E.value=b.locationName;a();m()};pts.openHtmlModal("location-select",
{onshow:function(){var a=document.createElement("div");a.className="list is-hoverable has-margin-bottom-20";for(var d=$jscomp.makeIterator(n.values()),f=d.next();!f.done;f=d.next()){var f=f.value,e=document.createElement("a");e.className="list-item";e.setAttribute("data-location-key",f.locationKey);e.setAttribute("href","#");e.innerHTML='<div class="level">'+('<div class="level-left">'+pts.escapeHTML(f.locationName)+"</div>")+'<div class="level-right">'+pts.escapeHTML(c.has(f.locationClassKey)?c.get(f.locationClassKey).locationClass:
f.locationClassKey)+"</div></div>";e.addEventListener("click",b);a.appendChild(e)}d=document.getElementById("container--parkingLocations");pts.clearElement(d);d.appendChild(a)},onshown:function(b,c){a=c}})});document.getElementById("is-clear-location-filter-button").addEventListener("click",function(){l();m()});r||l();document.getElementById("is-select-bylaw-filter-button").addEventListener("click",function(){var a,b=function(b){b.preventDefault();b=q.get(b.currentTarget.getAttribute("data-bylaw-number"));
x=!0;u=b.bylawNumber;F.value=b.bylawNumber;G.innerText=b.bylawDescription;a();m()};pts.openHtmlModal("bylaw-select",{onshow:function(){var a=document.createElement("div");a.className="list is-hoverable has-margin-bottom-20";for(var c=$jscomp.makeIterator(q.values()),d=c.next();!d.done;d=c.next()){var d=d.value,e=document.createElement("a");e.className="list-item";e.setAttribute("data-bylaw-number",d.bylawNumber);e.setAttribute("href","#");e.innerHTML=pts.escapeHTML(d.bylawNumber)+'<br /><span class="is-size-7">'+
pts.escapeHTML(d.bylawDescription)+"</span>";e.addEventListener("click",b);a.appendChild(e)}c=document.getElementById("container--parkingBylaws");pts.clearElement(c);c.appendChild(a)},onshown:function(b,c){a=c}})});document.getElementById("is-clear-bylaw-filter-button").addEventListener("click",function(){B();m()});x||B();C.addEventListener("change",m);for(var v=0;v<pts.locationsInit.length;v+=1){var A=pts.locationsInit[v];n.set(A.locationKey,A)}delete pts.locationsInit;for(v=0;v<pts.bylawsInit.length;v+=
1)A=pts.bylawsInit[v],q.set(A.bylawNumber,A);delete pts.bylawsInit;e(pts.offencesInit);delete pts.offencesInit;pts.getDefaultConfigProperty("locationClasses",function(a){for(var b=0;b<a.length;b+=1){var d=a[b];c.set(d.locationClassKey,d)}m()})})();
