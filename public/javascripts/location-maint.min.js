"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),(()=>{var e;let t="";const o=document.querySelector("#locationFilter--locationClassKey"),n=document.querySelector("#locationFilter--locationName"),a=document.querySelector("#locationResults");let l=exports.locations;function i(e){var o;e.preventDefault();const n=Number.parseInt(null!==(o=e.currentTarget.dataset.index)&&void 0!==o?o:"-1",10),a=l[n];let i;function c(){cityssm.postJSON("/admin/doDeleteLocation",{locationKey:a.locationKey},e=>{const t=e;t.success&&(i(),l=t.locations,s())})}function r(e){e.preventDefault(),cityssm.confirmModal("Delete Location",`Are you sure you want to remove "${a.locationName}" from the list of available options?`,"Yes, Remove Location","danger",c)}function d(e){e.preventDefault(),cityssm.postJSON("/admin/doUpdateLocation",e.currentTarget,e=>{const t=e;t.success&&(i(),l=t.locations,s())})}cityssm.openHtmlModal("location-edit",{onshow(){document.querySelector("#editLocation--locationKey").value=a.locationKey;const e=document.querySelector("#editLocation--locationClassKey");e.innerHTML=t,null===e.querySelector(`[value='${a.locationClassKey}']`)&&e.insertAdjacentHTML("beforeend",`<option value="${cityssm.escapeHTML(a.locationClassKey)}">\n              ${cityssm.escapeHTML(a.locationClassKey)}\n              </option>`),e.value=a.locationClassKey,document.querySelector("#editLocation--locationName").value=a.locationName},onshown(e,t){var o,n;bulmaJS.toggleHtmlClipped(),i=t,null===(o=document.querySelector("#form--editLocation"))||void 0===o||o.addEventListener("submit",d),null===(n=e.querySelector(".is-delete-button"))||void 0===n||n.addEventListener("click",r)},onhidden(){bulmaJS.toggleHtmlClipped()}})}function s(){var e,t;let s=0;const c=o.value,r=n.value.trim().toLowerCase().split(" "),d=document.createElement("tbody");for(const[t,o]of l.entries()){if(""!==c&&c!==o.locationClassKey)continue;let n=!0;const a=o.locationName.toLowerCase();for(const e of r)if(!a.includes(e)){n=!1;break}if(!n)continue;s+=1;const l=pts.getLocationClass(o.locationClassKey).locationClass,u=document.createElement("tr");u.innerHTML=`<td>\n          <a data-index="${t.toString()}" href="#">\n          ${cityssm.escapeHTML(o.locationName)}\n          </a>\n        </td><td>\n          ${cityssm.escapeHTML(l)}\n        </td>`,null===(e=u.querySelector("a"))||void 0===e||e.addEventListener("click",i),d.append(u)}cityssm.clearElement(a),0!==s?(a.innerHTML='<table class="table is-fixed is-striped is-hoverable is-fullwidth">\n        <thead><tr>\n          <th>Location</th>\n          <th>Class</th>\n        </tr></thead>\n        </table>',null===(t=a.querySelector("table"))||void 0===t||t.append(d)):a.innerHTML='<div class="message is-info">\n          <div class="message-body">There are no locations that meet your search criteria.</div>\n          </div>'}delete exports.locations,o.addEventListener("change",s),n.addEventListener("keyup",s),pts.getDefaultConfigProperty("locationClasses",e=>{o.innerHTML='<option value="">(All Location Classes)</option>';for(const o of e)t+=`<option value="${o.locationClassKey}">\n          ${cityssm.escapeHTML(o.locationClass)}\n          </option>`;o.insertAdjacentHTML("beforeend",t),s()}),null===(e=document.querySelector("#is-add-location-button"))||void 0===e||e.addEventListener("click",e=>{let o;function n(e){e.preventDefault(),cityssm.postJSON("/admin/doAddLocation",e.currentTarget,e=>{var t;const n=e;n.success?(o(),l=n.locations,s()):cityssm.alertModal("Location Not Added",null!==(t=n.message)&&void 0!==t?t:"","OK","danger")})}e.preventDefault(),cityssm.openHtmlModal("location-add",{onshown(e,a){var l,i;o=a,null===(l=document.querySelector("#addLocation--locationClassKey"))||void 0===l||l.insertAdjacentHTML("beforeend",t),null===(i=document.querySelector("#form--addLocation"))||void 0===i||i.addEventListener("submit",n)}})})})();