"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),(()=>{const e={};let t="";const a=document.getElementById("form--filters"),s=document.getElementById("filter--limit"),i=document.getElementById("filter--offset"),n=document.getElementById("container--searchResults"),l=()=>{const c=parseInt(s.value,10),o=parseInt(i.value,10);cityssm.clearElement(n),n.innerHTML='<p class="has-text-centered has-text-grey-lighter"><i class="fas fa-3x fa-circle-notch fa-spin" aria-hidden="true"></i><br /><em>Loading tickets...</p>',cityssm.postJSON("/tickets/doGetTickets",a,a=>{const s=a.tickets;if(0===s.length)return void(n.innerHTML='<div class="message is-info"><div class="message-body"><strong>Your search returned no results.</strong><br />Please try expanding your search criteria.</div></div>');n.innerHTML='<table class="table is-fullwidth is-striped is-hoverable"><thead><tr><th>'+cityssm.escapeHTML(t)+"</th><th>Issue Date</th><th>Plate Number</th><th>Location</th><th>Offence</th><th>Status</th></tr></thead><tbody></tbody></table>";const r=n.getElementsByTagName("tbody")[0];for(const t of s){const a=document.createElement("tr"),s=pts.getLicencePlateLocationProperties(t.licencePlateCountry,t.licencePlateProvince);let i="";if(t.locationClassKey){const a=e[t.locationClassKey];a&&(i=a.locationClass)}const n=pts.getTicketStatus(t.latestStatus_statusKey);a.innerHTML='<td><a href="/tickets/'+t.ticketID+'" data-tooltip="View Parking Ticket">'+t.ticketNumber+'</a></td><td class="is-nowrap">'+t.issueDateString+'</td><td><div class="licence-plate is-fullwidth" style="--color:'+s.licencePlateProvince.color+";--backgroundColor:"+s.licencePlateProvince.backgroundColor+'"><div class="licence-plate-province">'+s.licencePlateProvinceAlias+'</div><div class="licence-plate-number">'+(""===t.licencePlateNumber?'<i class="fas fa-question-circle has-opacity-2" aria-hidden="true"></i>':cityssm.escapeHTML(t.licencePlateNumber))+"</div></div></td><td>"+(t.locationDescription?cityssm.escapeHTML(t.locationDescription)+"<br />":"")+(t.locationKey&&""!==t.locationKey&&t.locationName?'<small class="has-tooltip-right" data-tooltip="'+cityssm.escapeHTML(i)+'"><i class="fas fa-map-marker-alt" aria-hidden="true"></i> '+t.locationName+"</small>":"")+"</td><td>"+cityssm.escapeHTML(t.parkingOffence)+"</td><td>"+(""===t.resolvedDateString?"Unresolved":'<span class="sr-only">Resolved</span><i class="fas fa-check" aria-hidden="true"></i> '+t.resolvedDateString)+(t.latestStatus_statusKey?'<br /><span class="tag is-light is-primary">'+n.status+"</span>":"")+"</td>",r.appendChild(a)}if(n.insertAdjacentHTML("beforeend",'<div class="level is-block-print"><div class="level-left has-text-weight-bold">Displaying parking tickets '+(o+1)+" to "+Math.min(c+o,a.count)+" of "+a.count+"</div></div>"),c<a.count){const e=document.createElement("nav");if(e.className="level-right is-hidden-print",e.setAttribute("role","pagination"),e.setAttribute("aria-label","pagination"),o>0){const t=document.createElement("a");t.className="button",t.innerText="Previous",t.addEventListener("click",e=>{e.preventDefault(),i.value=Math.max(0,o-c).toString(),n.scrollIntoView(!0),l()}),e.appendChild(t)}if(c+o<a.count){const t=document.createElement("a");t.className="button ml-3",t.innerHTML='<span>Next Tickets</span><span class="icon"><i class="fas fa-chevron-right" aria-hidden="true"></i></span>',t.addEventListener("click",e=>{e.preventDefault(),i.value=(o+c).toString(),n.scrollIntoView(!0),l()}),e.appendChild(t)}n.getElementsByClassName("level")[0].appendChild(e)}})},c=()=>{i.value="0",l()};a.addEventListener("submit",e=>{e.preventDefault()}),document.getElementById("filter--ticketNumber").addEventListener("change",c),document.getElementById("filter--licencePlateNumber").addEventListener("change",c),document.getElementById("filter--location").addEventListener("change",c),document.getElementById("filter--isResolved").addEventListener("change",c),pts.getDefaultConfigProperty("ticketNumber_fieldLabel",a=>{t=a,pts.getDefaultConfigProperty("locationClasses",t=>{for(const a of t)e[a.locationClassKey]=a;l()})})})();