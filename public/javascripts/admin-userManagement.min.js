"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),(()=>{const e=document.querySelector("#is-create-user-modal");e.querySelector("form").addEventListener("submit",e=>{e.preventDefault(),cityssm.postJSON("/admin/doCreateUser",e.currentTarget,e=>{e.success&&window.location.reload()})}),document.querySelector("#is-create-user-button").addEventListener("click",()=>{cityssm.showModal(e)});let t=e.querySelectorAll(".is-cancel-button");for(const e of t)e.addEventListener("click",cityssm.hideModal);const s=document.querySelector("#container--users"),r=e=>{e.preventDefault();const t=e.currentTarget,s=t.getAttribute("data-user-name"),r=t.closest("tr");cityssm.confirmModal("Delete User?",`Are you sure you want to delete <em>${s}/em>?<br />`,"Yes, Delete","warning",()=>{cityssm.postJSON("/admin/doDeleteUser",{userName:s},e=>{e.success&&r.remove()})})},n=s.querySelectorAll(".is-delete-user-button");for(const e of n)e.addEventListener("click",r);const o=document.querySelector("#is-update-user-modal"),a=o.querySelectorAll(".container--userName");pts.initializeTabs(o.querySelector(".tabs ul"));const c=e=>{e.preventDefault();const t=e.currentTarget;cityssm.postJSON("/admin/doUpdateUserProperty",t,e=>{if(e.success){const e=t.querySelector(".input");e.classList.add("is-success"),e.classList.remove("is-danger");const s=t.querySelector("button");s.classList.add("is-success"),s.classList.remove("is-danger")}})},i=e=>{const t=e.currentTarget;t.classList.add("is-danger"),t.classList.remove("is-primary"),t.classList.remove("is-success");const s=t.closest(".field").querySelector("button");s.classList.add("is-danger"),s.classList.remove("is-primary"),s.classList.remove("is-success")},u=e=>{const t=e.currentTarget,s=t.getAttribute("data-user-name"),r=t.getAttribute("data-first-name"),n=t.getAttribute("data-last-name");for(const e of a)e.textContent=s;document.querySelector("#updateUser--userName").value=s,document.querySelector("#updateUser--firstName").value=r,document.querySelector("#updateUser--lastName").value=n;const u=document.querySelector("#container--userProperties");cityssm.clearElement(u),cityssm.postJSON("/admin/doGetUserProperties",{userName:s},e=>{let t=0;for(const r in e)if(Object.prototype.hasOwnProperty.call(e,r)){t+=1;const n=e[r],o=document.createElement("form");o.innerHTML=`<input name="userName" type="hidden" value="${s}" />\n              <input name="propertyName" type="hidden" value="${r}" />\n              <div class="columns">\n              <div class="column is-4">\n                <label class="label" for="userProperties--propertyValue-${t.toString()}">\n                ${r}\n                </label>\n                </div>\n              <div class="column">\n                <div class="field has-addons">\n                <div class="control is-expanded">\n                <input class="input is-primary" +\n                  id="userProperties--propertyValue-${t.toString()}"\n                  name="propertyValue"\n                  type="text"\n                  value="${cityssm.escapeHTML(n)}"\n                  placeholder="(Use Default)" />\n                </div>\n                <div class="control">\n                <button class="button is-outlined is-primary" type="submit">Save</button>\n                </div>\n                </div>\n                </div>\n              </div>`,o.querySelector(".input").addEventListener("keyup",i),o.addEventListener("submit",c),u.append(o)}}),document.querySelector("#resetPassword--userName").value=s,document.querySelector("#resetPassword--newPassword").closest(".message").setAttribute("hidden","hidden"),cityssm.showModal(o)},d=s.querySelectorAll(".is-update-user-button");for(const e of d)e.addEventListener("click",u);t=o.querySelectorAll(".is-cancel-button");for(const e of t)e.addEventListener("click",cityssm.hideModal);document.querySelector("#tab--updateUser-name form").addEventListener("submit",e=>{e.preventDefault(),cityssm.postJSON("/admin/doUpdateUser",e.currentTarget,e=>{e.success&&window.location.reload()})}),document.querySelector("#tab--updateUser-password form").addEventListener("submit",e=>{e.preventDefault(),cityssm.postJSON("/admin/doResetPassword",e.currentTarget,e=>{if(e.success){const t=document.querySelector("#resetPassword--newPassword");t.textContent=e.newPassword,t.closest(".message").removeAttribute("hidden")}})})})();